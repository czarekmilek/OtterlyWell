import{j as e,Q as Y,F as q,i as R,r as x,z as G,K as H,l as U,O as I,k as J,D as Q}from"./index-BseDcRp9.js";import{a as $,F as V,u as X}from"./FinanceIOPeek-B379wuqs.js";import{C as ee,A as te}from"./ConfirmDeleteDialog-BnB7wdqZ.js";import{m as F}from"./proxy-CBzavYgd.js";import{D as ne}from"./DateSelector-BJduf_Le.js";function re({type:t,onClose:r}){return e.jsxs("div",{className:"bg-brand-neutral-dark border-b border-brand-depth px-4 py-3 sm:px-6 flex justify-between items-center",children:[e.jsxs(Y,{as:"h3",className:"text-lg font-semibold leading-6 text-brand-neutral-light flex items-center gap-2",children:[e.jsx(q,{className:"text-brand-accent-1"}),t==="income"?"Dodaj przychód":"Dodaj wydatek"]}),e.jsx("button",{type:"button",onClick:r,className:`text-brand-secondary hover:text-brand-neutral-dark hover:bg-brand-neutral-light/70 rounded-full \r
                  p-1 flex items-center justify-center cursor-pointer transition-all`,children:e.jsx(R,{})})]})}function se({type:t,setType:r}){return e.jsxs("div",{className:"flex rounded-md bg-brand-neutral-dark/50 p-1 border border-brand-depth",children:[e.jsx("button",{type:"button",onClick:()=>r("expense"),className:`flex-1 py-1.5 text-sm font-medium rounded ${t==="expense"?"bg-brand-negative/20 text-brand-negative shadow-sm":"text-brand-secondary hover:text-brand-neutral-light cursor-pointer"}`,children:"Wydatek"}),e.jsx("button",{type:"button",onClick:()=>r("income"),className:`flex-1 py-1.5 text-sm font-medium rounded ${t==="income"?"bg-brand-positive-lighter/20 text-brand-positive-lighter shadow-sm":"text-brand-secondary hover:text-brand-neutral-light cursor-pointer"}`,children:"Przychód"})]})}const Z=x.forwardRef(({isOpen:t,onClose:r,onSubmit:i,categories:c,initialType:a="expense",initialData:l},b)=>{const[p,f]=x.useState(l?.type||a),[g,h]=x.useState(l?.amount.toString()||""),[N,y]=x.useState(l?.title||""),[d,w]=x.useState(l?.description||""),[j,v]=x.useState(l?.category_id||""),[C,z]=x.useState(l?.date||new Date().toISOString().split("T")[0]),[S,n]=x.useState(!1);x.useEffect(()=>{t&&(l?(f(l.type),h(l.amount.toString()),y(l.title),w(l.description||""),v(l.category_id||""),z(l.date)):(f(a),h(""),y(""),w(""),v(""),z(new Date().toISOString().split("T")[0])))},[t,a,l]);const o=async s=>{s.preventDefault(),n(!0);try{await i({type:p,amount:parseFloat(g),title:N,description:d||null,category_id:j||null,date:C}),r()}catch(m){console.error(m)}finally{n(!1)}},u=c.filter(s=>s.type===p);return e.jsxs(G,{ref:b,className:`relative transform overflow-hidden rounded-xl bg-brand-neutral-dark border border-brand-depth text-left \r
                        shadow-xl transition-all sm:my-8 w-full sm:max-w-lg`,children:[e.jsx(re,{type:p,onClose:r}),e.jsxs("form",{onSubmit:o,className:"p-4 sm:p-6 space-y-4",children:[e.jsx(se,{type:p,setType:f}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-brand-neutral-light",children:"Kwota"}),e.jsx("input",{type:"number",step:"0.01",min:"0",required:!0,value:g,onChange:s=>h(s.target.value),className:`mt-1 block w-full rounded-md border border-brand-depth bg-brand-neutral-light/5 px-3 py-2 \r
                  text-brand-neutral-light focus:border-brand-accent-1 focus:ring-1 focus:ring-brand-accent-1 \r
                    focus:outline-none sm:text-sm`,placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-brand-neutral-light",children:"Tytuł"}),e.jsx("input",{type:"text",required:!0,value:N,onChange:s=>y(s.target.value),className:`mt-1 block w-full rounded-md border border-brand-depth bg-brand-neutral-light/5 px-3 py-2 \r
                    text-brand-neutral-light focus:border-brand-accent-1 focus:ring-1 focus:ring-brand-accent-1 \r
                      focus:outline-none sm:text-sm`,placeholder:"np. Zakupy spożywcze"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-brand-neutral-light",children:"Kategoria (opcjonalnie)"}),e.jsxs("select",{value:j,onChange:s=>v(s.target.value),className:"mt-1 block w-full rounded-md border border-brand-depth bg-brand-neutral-light/5 px-3 py-2 text-brand-neutral-light focus:border-brand-accent-1 focus:ring-1 focus:ring-brand-accent-1 focus:outline-none sm:text-sm appearance-none",children:[e.jsx("option",{value:"",className:"bg-brand-neutral-dark",children:"Wybierz kategorię"}),u.map(s=>e.jsx("option",{value:s.id,className:"bg-brand-neutral-dark",children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-brand-neutral-light",children:"Data"}),e.jsx("input",{type:"date",required:!0,value:C,onChange:s=>z(s.target.value),className:"mt-1 block w-full rounded-md border border-brand-depth bg-brand-neutral-light/5 px-3 py-2 text-brand-neutral-light focus:border-brand-accent-1 focus:ring-1 focus:ring-brand-accent-1 focus:outline-none sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-brand-neutral-light",children:"Opis (opcjonalnie)"}),e.jsx("textarea",{value:d,onChange:s=>w(s.target.value),rows:3,className:`mt-1 block w-full rounded-md border border-brand-depth bg-brand-neutral-light/5 px-3 py-2 text-brand-neutral-light \r
                  focus:border-brand-accent-1 focus:ring-1 focus:ring-brand-accent-1 focus:outline-none sm:text-sm`})]}),e.jsx("div",{className:"mt-5 sm:mt-6",children:e.jsx("button",{type:"submit",disabled:S,className:`inline-flex w-full justify-center rounded-md bg-brand-accent-1 px-3 py-2 text-sm font-semibold text-brand-neutral-dark shadow-sm \r
                    hover:bg-brand-accent-2 focus-visible:outline focus-visible:outline-offset-2 focus-visible:outline-brand-accent-1 disabled:opacity-50\r
                    disabled:cursor-not-allowed cursor-pointer`,children:S?"Zapisywanie...":"Zapisz"})})]})]})});Z.displayName="EntryForm";function W({isOpen:t,onClose:r,onSubmit:i,categories:c,initialType:a="expense",initialData:l}){return e.jsx(H,{show:t,as:x.Fragment,children:e.jsxs(U,{as:"div",className:"relative z-50",onClose:r,children:[e.jsx(I,{as:x.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-brand-neutral-dark/80"})}),e.jsx("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-2 text-center sm:p-0",children:e.jsx(I,{as:x.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:e.jsx(Z,{isOpen:t,onClose:r,onSubmit:i,categories:c,initialType:a,initialData:l})})})})]})})}const E="#9ca3af",ae={Płatności:"#f87171",Transport:"#fb923c",Jedzenie:"#fbbf24",Codzienne:"#2dd4bf",Zdrowie:"#34d399",Dom:"#60a5fa",Samorozwój:"#f472b6",Rozrywka:"#e879f9",Oszczędności:"#4ade80",Wynagrodzenie:"#4ade80",Inwestycje:"#818cf8",Prezenty:"#2dd4bf",Inne:"#9ca3af"},O=t=>t&&ae[t]||E,M="payments",le={Płatności:"payments",Transport:"directions_car",Jedzenie:"restaurant",Codzienne:"shopping_cart",Zdrowie:"medical_services",Dom:"home",Samorozwój:"person",Rozrywka:"theater_comedy",Oszczędności:"save",Wynagrodzenie:"payments",Inwestycje:"",Prezenty:"",Inne:"category"},_=t=>t&&le[t]||M;function de({transaction:t,categories:r,onDelete:i,onEdit:c}){const[a,l]=x.useState(!1),[b,p]=x.useState(!1),[f,g]=x.useState(!1),h=O(t.finance_categories?.name),N=_(t.finance_categories?.name);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{onClick:()=>l(!a),className:`grid grid-cols-2 p-2 rounded-lg
                   hover:bg-brand-neutral-dark/90 transition-colors duration-300 cursor-pointer ${a?"bg-brand-neutral-dark/60":"bg-brand-neutral-dark/40"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 self-start",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 shrink-0 rounded-full text-brand-neutral-light",style:{backgroundColor:`${h}21`},children:e.jsx("span",{className:"material-symbols-sharp",style:{color:h},children:N})}),e.jsxs("div",{className:"flex flex-col justify-center",children:[e.jsx("span",{className:`font-medium text-brand-neutral-light text-sm line-clamp-2 overflow-hidden \r
                          text-ellipsis`,children:t.title}),e.jsx("span",{className:"text-xs text-brand-secondary",children:t.finance_categories?t.finance_categories.name:"Nieskategoryzowane"})]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-start h-full gap-1",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:`font-bold text-sm whitespace-nowrap ${t.type==="income"?"text-brand-positive-lighter":"text-brand-negative"}`,children:[t.type==="income"?"+":"-",t.amount.toFixed(2),e.jsx("span",{className:"text-xs ml-1",children:"PLN"})]})}),a?e.jsxs("div",{className:"flex items-end justify-end gap-1",children:[e.jsx("button",{onClick:y=>{y.stopPropagation(),g(!0)},className:`flex items-center p-1 text-brand-neutral-light hover:bg-brand-neutral-light/10\r
                      rounded-full transition-all cursor-pointer`,title:"Edytuj",children:e.jsx(J,{className:"scale-80"})}),e.jsx("button",{onClick:y=>{y.stopPropagation(),p(!0)},className:`flex items-center p-1 text-brand-negative hover:bg-brand-negative/10\r
                      rounded-full transition-all cursor-pointer`,title:"Usuń",children:e.jsx(Q,{})})]}):null]}),a?e.jsxs("div",{className:`col-span-2 bg-brand-neutral-dark/40 p-2 -mx-2 -mb-2 rounded-b-lg ${t.title.length>15?"mt-2":""}`,children:[e.jsx("div",{className:"text-sm text-brand-neutral-light font-semibold text-wrap break-words px-1",children:t.title}),e.jsx("div",{className:"text-xs text-brand-secondary/80 text-wrap break-words p-1",children:t.description?t.description:"Brak opisu"})]}):null]}),e.jsx(ee,{isOpen:b,onClose:()=>p(!1),onConfirm:()=>i(t.id),description:e.jsxs("p",{children:["Czy na pewno chcesz usunąć transakcję"," ",e.jsx("strong",{className:"text-brand-neutral-light",children:t.title}),"? Tej akcji nie można cofnąć."]})}),e.jsx(W,{isOpen:f,onClose:()=>g(!1),onSubmit:y=>c(t.id,y),categories:r,initialData:t})]})}function ie({date:t,transactions:r,categories:i,onDelete:c,onEdit:a}){const l=new Intl.DateTimeFormat("pl-PL",{weekday:"long",day:"numeric",month:"long"});return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-px bg-brand-depth"}),e.jsx("h3",{className:"text-xs font-bold text-brand-secondary uppercase tracking-wider",children:l.format(new Date(t))}),e.jsx("div",{className:"flex-1 h-px bg-brand-depth"})]}),e.jsx("div",{className:"space-y-2",children:r.map(b=>e.jsx(de,{transaction:b,categories:i,onDelete:c,onEdit:a},b.id))})]})}function oe(){return e.jsx("div",{className:"relative overflow-hidden",children:e.jsx("div",{className:"space-y-4",children:[1,2,3].map(t=>e.jsx("div",{className:"h-16 bg-brand-neutral-dark/30 rounded-lg animate-pulse"},t))})})}function P({name:t,isActive:r,onToggle:i}){const c=O(t),a=_(t);return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-brand-neutral-dark/30 rounded-xl border border-brand-depth/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-brand-primary-dark",style:{backgroundColor:c},children:e.jsx("span",{className:"material-symbols-sharp",children:a})}),e.jsx("span",{className:"font-medium text-sm md:text-base text-brand-neutral-light",children:t})]}),e.jsx("button",{onClick:()=>i(!r),className:`relative w-12 h-6 rounded-full transition-colors duration-200 ease-in-out cursor-pointer ${r?"bg-brand-accent-1":"bg-brand-neutral-dark"}`,children:e.jsx(F.div,{initial:!1,animate:{x:r?26:7},className:"absolute top-1 w-4 h-4 rounded-full bg-white shadow-sm"})})]})}function K({isOpen:t,onClose:r,categories:i,onToggleCategory:c,showIncomeCategories:a=!1,onToggleAll:l}){const b=i.filter(d=>d.type==="expense").map(d=>d.name),p=i.filter(d=>d.type==="income").map(d=>d.name),f=Array.from(new Set(b)),g=Array.from(new Set(p)),h=(d,w)=>{const j=i.find(v=>v.name===d&&v.type===w);return j?j.is_active:!1},N=d=>(d==="expense"?f:g).every(j=>h(j,d)),y=d=>{if(l){const w=!N(d);l(d,w)}};return e.jsx(te,{children:t&&e.jsxs(e.Fragment,{children:[e.jsx(F.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,className:"fixed inset-0 bg-brand-neutral-darker/70 backdrop-blur-sm z-50"}),e.jsx(F.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"fixed inset-0 flex items-center justify-center z-50 pointer-events-none",children:e.jsxs("div",{className:`overflow-hidden flex flex-col w-full max-w-2xl max-h-[85vh] bg-brand-neutral-darker border border-brand-depth \r
                          rounded-2xl shadow-2xl pointer-events-auto mx-4`,children:[e.jsxs("div",{className:"p-6 border-b border-brand-depth flex justify-between items-center bg-brand-neutral-dark/50",children:[e.jsx("h2",{className:"text-xl font-bold text-brand-neutral-light",children:"Aktywne kategorie"}),e.jsx("button",{onClick:r,className:`text-brand-secondary hover:text-brand-neutral-dark hover:bg-brand-neutral-light/70 rounded-full \r
                  p-1 flex items-center justify-center cursor-pointer transition-all`,children:e.jsx(R,{})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[e.jsxs("section",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-1",children:[e.jsx("h3",{className:"text-sm uppercase tracking-wider text-brand-negative font-semibold",children:"Wydatki"}),l&&e.jsx("button",{onClick:()=>y("expense"),className:"text-xs font-medium text-brand-accent-1 hover:text-brand-accent-2 transition-colors cursor-pointer",children:N("expense")?"Odznacz wszystkie":"Zaznacz wszystkie"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:f.map(d=>e.jsx(P,{name:d,isActive:h(d,"expense"),onToggle:()=>c(d,"expense")},`expense-${d}`))})]}),a&&e.jsxs("section",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-1 border-t border-brand-depth pt-6",children:[e.jsx("h3",{className:"text-sm uppercase tracking-wider text-brand-positive font-semibold",children:"Przychody"}),l&&e.jsx("button",{onClick:()=>y("income"),className:"text-xs font-medium text-brand-accent-1 hover:text-brand-accent-2 transition-colors cursor-pointer",children:N("income")?"Odznacz wszystkie":"Zaznacz wszystkie"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:g.map(d=>e.jsx(P,{name:d,isActive:h(d,"income"),onToggle:()=>c(d,"income")},`income-${d}`))})]})]}),e.jsx("div",{className:"p-4 border-t border-brand-depth bg-brand-neutral-dark/30 text-center",children:e.jsx("p",{className:"text-xs text-brand-neutral-light/50",children:"Wybierz kategorie, które chcesz widzieć."})})]})})]})})}function ce({transactions:t,categories:r,isLoading:i,onDelete:c,onEdit:a}){const[l,b]=x.useState(new Set),[p,f]=x.useState(!1);if(i)return e.jsx(oe,{});if(t.length===0)return e.jsx("div",{className:"text-center text-brand-secondary py-8",children:"Brak transakcji. Dodaj pierwszą!"});const g=new Map;t.forEach(n=>{if(n.finance_categories){const o=`${n.finance_categories.name}-${n.finance_categories.type}`;g.has(o)||g.set(o,n.finance_categories)}});const h=(n,o)=>{const u=`${n}-${o}`;b(s=>{const m=new Set(s);return m.has(u)?m.delete(u):m.add(u),m})},N=(n,o)=>{b(u=>{const s=new Set(u);return Array.from(g.values()).filter(k=>k.type===n).forEach(k=>{const T=`${k.name}-${k.type}`;o?s.delete(T):s.add(T)}),s})},y=()=>{b(new Set)},w=t.filter(n=>{if(n.finance_categories){const o=`${n.finance_categories.name}-${n.finance_categories.type}`;if(l.has(o))return!1}return!0}).reduce((n,o)=>{const u=o.date;return n[u]||(n[u]=[]),n[u].push(o),n},{}),j=Object.keys(w).sort((n,o)=>new Date(o).getTime()-new Date(n).getTime()),v=Array.from(g.values()).map(n=>({...n,is_active:!l.has(`${n.name}-${n.type}`)})),C=v.filter(n=>n.is_active).length,z=v.length,S=l.size>0;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center mb-4",children:[e.jsx("div",{className:"flex gap-2 justify-start w-full sm:w-auto",children:e.jsx("button",{onClick:()=>f(!0),className:`py-1 px-2 flex items-center justify-center rounded-lg transition-colors ${S?"bg-brand-accent-1 text-brand-neutral-darker hover:bg-brand-accent-1/80 cursor-pointer":"bg-brand-neutral-dark/50 text-brand-secondary hover:bg-brand-neutral-dark/70 cursor-pointer"}`,children:e.jsx("span",{className:"material-symbols-sharp",children:"filter_list"})})}),S&&e.jsxs("button",{onClick:y,className:"text-end text-xs text-brand-secondary hover:text-brand-accent-1 transition-colors cursor-pointer sm:ml-1",children:["Aktywne filtry: ",C,"/",z," (kliknij, aby wyczyścić)"]})]}),j.length>0?j.map(n=>e.jsx(ie,{date:n,transactions:w[n],categories:r,onDelete:c,onEdit:a},n)):e.jsx("div",{className:"flex flex-col items-center justify-center py-8 text-brand-secondary",children:e.jsx("p",{className:"text-sm",children:"Brak transakcji spełniających kryteria"})}),e.jsx(K,{isOpen:p,onClose:()=>f(!1),categories:v,onToggleCategory:h,onToggleAll:N,showIncomeCategories:!0})]})}function A({category:t,amount:r,spent:i,editMode:c,editValue:a,onEdit:l}){const b=O(t.name),p=_(t.name),f=a!==void 0?a:r.toString();return e.jsx("div",{children:e.jsxs("div",{className:`grid grid-cols-[minmax(0,1fr)_auto] rounded-xl bg-brand-neutral-dark/40 \r
                  hover:bg-brand-neutral-dark/80 transition-colors`,children:[e.jsxs("div",{className:"flex items-center gap-1 min-w-0",children:[e.jsx("div",{className:`w-10 min-h-10 ml-1 rounded-l-xl flex items-center justify-center\r
                      text-brand-neutral-light shrink-0`,style:{color:`${b}`},children:e.jsx("span",{className:"material-symbols-sharp",children:p})}),e.jsx("span",{className:"font-semibold text-sm sm:text-base text-brand-neutral-light truncate",children:t.name})]}),e.jsx("div",{className:"flex justify-between items-center min-h-10 ml-auto  px-4 py-1.5 rounded-r-xl",children:c?e.jsx("input",{type:"number",value:f,onChange:g=>l?.(g.target.value),className:`w-full bg-brand-neutral-light/5 border border-brand-depth rounded-lg px-3 py-2 text-sm text-brand-neutral-light focus:outline-none \r
                        focus:border-brand-accent-2 transition-colors`,autoFocus:!0,placeholder:"0"}):e.jsxs("p",{className:"font-bold text-brand-neutral-light/60",children:[e.jsx("span",{className:`text-md md:text-xl font-medium uppercase     
                            tracking-wider mt-0.5 ${i>r?"text-brand-negative":"text-brand-neutral-light"}`,children:e.jsx("span",{className:"text-lg md:text-xl",children:i.toFixed(0)})}),e.jsx("span",{className:"text-xs md:text-sm mx-1 text-brand-neutral-light/60",children:"/"}),e.jsxs("span",{className:"text-sm md:text-base",children:[r.toFixed(0)," "]}),e.jsx("span",{className:"text-xs md:text-sm font-normal text-brand-secondary",children:"PLN"})]})})]})})}function xe({categories:t,budgets:r,onSaveBudget:i,categorySpending:c,onToggleCategory:a}){const[l,b]=x.useState(!1),p=t.filter(n=>n.is_active),f=p.filter(n=>n.type==="expense"),g=p.filter(n=>n.type==="income"),h=f.reduce((n,o)=>n+(c[o.id]||0),0),N=r.filter(n=>p.some(o=>o.id===n.category_id)).reduce((n,o)=>n+o.amount,0),[y]=x.useState("expense"),[d,w]=x.useState(!1),[j,v]=x.useState({}),C=()=>{d?S():(v({}),w(!0))},z=(n,o)=>{v(u=>({...u,[n]:o}))},S=async()=>{const n=Object.entries(j).map(([o,u])=>{const s=parseFloat(u);return isNaN(s)||s<0?Promise.resolve():i(o,s)});await Promise.all(n),w(!1),v({})};return e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex gap-2 items-center justify-between text-brand-neutral-light font-semibold",children:[e.jsx("button",{className:"px-4 py-2 rounded-lg bg-brand-secondary/80 hover:bg-brand-neutral-dark/70 transition-colors cursor-pointer",onClick:()=>b(!0),children:"Kategorie"}),e.jsxs("span",{className:`hidden sm:block text-brand-neutral-light bg-brand-neutral-dark px-8 py-2 -mb-7 rounded-t-full \r
                      font-semibold text-xl lg:text-lg text-center`,children:[h," /"," ",e.jsx("span",{className:"text-brand-accent-1 font-bold",children:N}),e.jsx("span",{className:"text-xs ml-1 font-normal",children:"PLN"})]}),e.jsx("button",{className:"px-4 py-2 rounded-lg bg-brand-secondary/80 hover:bg-brand-neutral-dark/70 transition-colors cursor-pointer",onClick:C,children:d?"Zapisz":"Edytuj"})]}),e.jsxs("span",{className:`block sm:hidden mx-auto mt-1 text-brand-neutral-light bg-brand-neutral-dark px-8 pt-2 pb-1 -mb-3 max-w-60 \r
                      rounded-t-full font-semibold text-lg text-center`,children:[h," /"," ",e.jsx("span",{className:"text-brand-accent-1 font-bold",children:N}),e.jsx("span",{className:"text-xs ml-1 font-normal",children:"PLN"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"h-5 w-full rounded-full bg-brand-neutral-dark overflow-hidden flex mb-1",children:e.jsx("div",{className:"h-full bg-brand-accent-3",style:{width:`${h/N*100}%`}})}),y==="expense"?f.map(n=>{const o=r.find(k=>k.category_id===n.id),u=o?o.amount:0,s=c[n.id]||0,m=j[n.id];return e.jsx(A,{category:n,amount:u,spent:s,editMode:d,editValue:m,onEdit:k=>z(n.id,k),onSave:async()=>{}},n.id)}):g.map(n=>{const o=r.find(k=>k.category_id===n.id),u=o?o.amount:0,s=c[n.id]||0,m=j[n.id];return e.jsx(A,{category:n,amount:u,spent:s,editMode:d,editValue:m,onEdit:k=>z(n.id,k),onSave:async()=>{}},n.id)})]}),e.jsx(K,{isOpen:l,onClose:()=>b(!1),categories:t,onToggleCategory:a})]})}function me({income:t,expense:r}){const i=t+r;let c=0;return i>0&&(c=t/i*100),i===0?e.jsx("div",{className:"relative flex items-center justify-center",children:e.jsx("div",{className:`flex items-center justify-center relative w-32 h-32 lg:w-64 lg:h-64 \r
                  bg-brand-neutral-dark border-4 border-brand-depth rounded-full \r
                  transition-all duration-300`,children:e.jsx("span",{className:"font-medium text-xs lg:text-lg text-brand-secondary uppercase tracking-wider",children:"Brak danych"})})}):e.jsx("div",{className:"relative flex items-center justify-center",children:e.jsx("div",{className:"w-64 h-64 rounded-full shadow-lg shadow-black/30 transition-all duration-300",style:{background:`conic-gradient(
                      var(--color-brand-positive) 0% ${c}%, 
                      var(--color-brand-negative) ${c}% 100%)`},children:e.jsxs("div",{className:`flex flex-col items-center justify-center absolute inset-0 m-auto w-42 h-42 \r
                    bg-brand-neutral-dark rounded-full border-4 border-brand-neutral-light/5 \r
                    transition-all duration-300`,children:[e.jsx("span",{className:"text-xs text-brand-secondary uppercase tracking-wider",children:"Bilans"}),e.jsxs("span",{className:`text-3xl font-bold ${t-r>=0?"text-brand-positive-lighter":"text-brand-negative"}`,children:[t-r>0?"+":"",(t-r).toFixed(0),e.jsx("span",{className:"text-lg font-normal text-brand-secondary ml-1",children:"PLN"})]})]})})})}function ue({stats:t,moneyLeft:r,totalBudget:i}){return e.jsx("div",{className:"bg-brand-neutral-dark/40 border border-brand-depth rounded-2xl p-6 relative",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 lg:gap-0",children:[e.jsxs("div",{className:"flex flex-col gap-4 order-2 lg:order-1",children:[e.jsx($,{type:"income",amount:t.income}),e.jsx($,{type:"expense",amount:t.expense})]}),e.jsx(F.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",duration:.8},className:"order-1 lg:order-2 lg:-mt-16 overflow-visible",children:e.jsx(me,{income:Math.abs(t.income),expense:Math.abs(t.expense)})}),e.jsx(V,{moneyLeft:r,totalBudget:i})]})})}const D=({handleOpenModal:t,incOrExp:r})=>e.jsxs("button",{onClick:()=>t(r),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium 
                  transition-colors border cursor-pointer ${r==="expense"?"bg-brand-negative/10 text-brand-negative border-brand-negative hover:bg-brand-negative/20":"bg-brand-positive/10 text-brand-positive border-brand-positive hover:bg-brand-positive/20"}`,children:[e.jsx("span",{className:"material-symbols-sharp",children:r==="expense"?"remove":"add"}),e.jsx("span",{children:r==="expense"?"Wydatek":"Przychód"})]});function B({label:t,value:r,isSelected:i,setSelectedTab:c}){return e.jsx("button",{className:`bg-brand-neutral-dark/50 text-xl font-bold text-brand-neutral-light border border-brand-depth rounded-t-xl py-2 px-4
                                  hover:bg-brand-neutral-dark/70 cursor-pointer transition-colors duration-150 ${i?"bg-brand-neutral-dark/70":""}`,onClick:()=>c(r),children:t})}const L=({category:t,amount:r})=>{const i=O(t.name),c=_(t.name);return e.jsx("div",{children:e.jsxs("div",{className:`grid grid-cols-[minmax(0,1fr)_auto] \r
                  transition-colors rounded-xl border-1 border-brand-depth/10`,style:{backgroundColor:`color-mix(in srgb, ${i}, gray 50%)`,backgroundImage:"linear-gradient(rgba(0,0,0,0.33), rgba(0,0,0,0.37))"},children:[e.jsxs("div",{className:"flex items-center gap-1 min-w-0",children:[e.jsx("div",{className:`w-10 min-h-10 ml-1 rounded-l-xl flex items-center justify-center\r
                      text-brand-neutral-light shrink-0`,style:{color:`${i}`},children:e.jsx("span",{className:"material-symbols-sharp",children:c})}),e.jsx("span",{className:"font-semibold text-sm sm:text-base text-brand-neutral-light truncate",children:t.name})]}),e.jsx("div",{className:"flex justify-between items-center min-h-10 ml-auto  px-4 py-1.5 rounded-r-xl",children:e.jsxs("p",{className:"font-bold text-brand-neutral-light/60",children:[e.jsx("span",{className:`text-md md:text-xl font-medium uppercase     
                            tracking-wider mt-0.5`,style:{color:`${i}`,filter:"brightness(1.33)"},children:e.jsx("span",{className:"text-lg md:text-xl",children:r.toFixed(0)})}),e.jsxs("span",{className:"text-xs md:text-sm font-normal text-brand-secondary",children:[" ","PLN"]})]})})]})})};function be({categories:t,categorySpending:r}){const i=t.filter(a=>a.type==="expense"&&(r[a.id]||0)!==0),c=t.filter(a=>a.type==="income"&&(r[a.id]||0)!==0);return e.jsx("div",{children:e.jsx("div",{className:"flex flex-col h-full relative max-w-80 sm:max-w-142 lg:max-w-none mx-auto",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 md:gap-2  relative z-10",children:[e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("h3",{className:`text-xl font-bold text-brand-positive-lighter bg-brand-neutral-dark\r
                            w-3/4 text-center py-2 rounded-t-3xl mx-auto`,children:"Przychody"}),c.map(a=>{const l=r[a.id]||0;return e.jsx(L,{category:a,amount:l},a.id)}),e.jsx("h3",{className:`text-xl font-bold text-brand-negative bg-brand-neutral-dark\r
                            w-3/4 text-center h-6 rounded-b-full mx-auto -mt-0.5`})]}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("h3",{className:`text-xl font-bold text-brand-negative bg-brand-neutral-dark\r
                            w-3/4 text-center h-6 rounded-t-full mx-auto -mt-0.5`}),i.map(a=>{const l=r[a.id]||0;return e.jsx(L,{category:a,amount:l},a.id)}),e.jsx("h3",{className:`text-xl font-bold text-brand-negative bg-brand-neutral-dark\r
                            w-3/4 text-center py-2 rounded-b-3xl mx-auto -mt-0.5`,children:"Wydatki"})]})]})})})}function je(){const{transactions:t,categories:r,budgets:i,isLoading:c,addTransaction:a,deleteTransaction:l,editTransaction:b,saveBudget:p,toggleCategory:f}=X(),[g,h]=x.useState(!1),[N,y]=x.useState("expense"),[d,w]=x.useState(new Date),[j,v]=x.useState("budget"),C=x.useMemo(()=>{const s=d.getMonth(),m=d.getFullYear();return t.filter(k=>{const T=new Date(k.date);return T.getMonth()===s&&T.getFullYear()===m})},[t,d]),z=x.useMemo(()=>C.reduce((s,m)=>(m.type==="income"?s.income+=m.amount:s.expense+=m.amount,s),{income:0,expense:0}),[C]),S=x.useMemo(()=>i.reduce((s,m)=>s+(m.amount||0),0),[i]),n=x.useMemo(()=>C.reduce((s,m)=>(m.category_id&&(s[m.category_id]=(s[m.category_id]||0)+m.amount),s),{}),[C]),o=S-z.expense,u=s=>{y(s),h(!0)};return e.jsxs(F.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"py-6 lg:p-8 mx-auto space-y-3 xl:h-[calc(100vh)]",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsx(ne,{selectedDate:d,onDateChange:w,format:"month"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(D,{handleOpenModal:u,incOrExp:"expense"}),e.jsx(D,{handleOpenModal:u,incOrExp:"income"})]})]}),e.jsx(ue,{stats:z,moneyLeft:o,totalBudget:S}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"",children:[e.jsx("div",{className:"flex items-end lg:justify-end",children:e.jsx("h2",{className:`bg-brand-neutral-dark/50 text-xl font-bold text-brand-neutral-light border border-brand-depth \r
                          rounded-t-xl py-2 px-4`,children:"Historia"})}),e.jsx("div",{className:`flex-grow overflow-y-auto max-h-[86vh] lg:max-h-[57vh] bg-brand-neutral-dark/40 border border-brand-depth \r
                        rounded-b-2xl rounded-tr-2xl lg:rounded-tr-none lg:rounded-tl-2xl p-4 sm:pb-8 lg:py-4 md:px-6`,children:e.jsx(ce,{transactions:C,categories:r,isLoading:c,onDelete:l,onEdit:b})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{label:"Budżet",value:"budget",isSelected:j==="budget",setSelectedTab:v}),e.jsx(B,{label:"Zestawienie",value:"stats",isSelected:j==="stats",setSelectedTab:v})]})}),e.jsx("div",{className:"overflow-y-auto max-h-[86vh] lg:max-h-[57vh] bg-brand-neutral-dark/40 border border-brand-depth rounded-b-2xl rounded-tr-2xl p-4 md:px-6",children:j==="budget"?e.jsx(xe,{categories:r,budgets:i,onSaveBudget:p,categorySpending:n,onToggleCategory:f}):e.jsx(be,{categories:r,categorySpending:n})})]})]}),e.jsx(W,{isOpen:g,onClose:()=>h(!1),onSubmit:a,categories:r,initialType:N})]})}export{je as default};
