import{r as n,j as e,l as F,z as G,i as M,k as T,D,a as _,s as S,A as B,m as L,S as E,o as q}from"./index-1dX7M82B.js";import{D as K}from"./DateSelector-CgO7mwVk.js";import{C as I,A as C}from"./ConfirmDeleteDialog-BlCcLmEk.js";import{m as y}from"./proxy-IKh-44iE.js";import{C as P}from"./CustomSelect-f8r9LygF.js";import{T as $}from"./TabButton-BktLqMPx.js";import{u as A,a as Z}from"./useFitnessDaily-E1qXnj5Q.js";const H=({isOpen:t,onClose:f,entry:s,onSave:j})=>{const[x,h]=n.useState(s.sets||0),[o,b]=n.useState(s.reps||0),[p,i]=n.useState(s.weight_kg||0),[l,g]=n.useState(s.duration_min||0),[N,w]=n.useState(s.distance_km||0);n.useEffect(()=>{t&&(h(s.sets||0),b(s.reps||0),i(s.weight_kg||0),g(s.duration_min||0),w(s.distance_km||0))},[s,t]);const c=async a=>{a.preventDefault();const d=s.exercise?.type||"strength";let m={};d==="strength"?m={sets:x,reps:o,weight_kg:p}:d==="cardio"?m={duration_min:l,distance_km:N}:d==="stretching"&&(m={duration_min:l}),await j(s.id,m),f()};return e.jsxs(F,{open:t,onClose:f,className:"relative z-50",children:[e.jsx("div",{className:"fixed inset-0 bg-brand-neutral-darker/70 backdrop-blur-sm","aria-hidden":"true"}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:e.jsxs(G,{className:"w-full max-w-sm rounded-2xl bg-brand-neutral-dark border border-brand-depth p-6 shadow-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-brand-neutral-light",children:"Edytuj trening"}),e.jsx("button",{onClick:f,className:`flex items-center justify-center text-brand-neutral-light/60 hover:text-brand-neutral-light transition-colors cursor-pointer \r
                        hover:bg-brand-neutral-light/10 rounded-full p-1`,children:e.jsx(M,{})})]}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[s.exercise?.type==="strength"&&e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-brand-neutral-light/80 mb-1",children:"Serie"}),e.jsx("input",{type:"number",value:x,onChange:a=>h(Number(a.target.value)),className:"w-full px-3 py-2 bg-brand-neutral-dark/40 border border-brand-depth rounded-xl text-brand-neutral-light focus:outline-none focus:border-brand-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-brand-neutral-light/80 mb-1",children:"Powt."}),e.jsx("input",{type:"number",value:o,onChange:a=>b(Number(a.target.value)),className:"w-full px-3 py-2 bg-brand-neutral-dark/40 border border-brand-depth rounded-xl text-brand-neutral-light focus:outline-none focus:border-brand-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-brand-neutral-light/80 mb-1",children:"Waga (kg)"}),e.jsx("input",{type:"number",value:p,onChange:a=>i(Number(a.target.value)),className:"w-full px-3 py-2 bg-brand-neutral-dark/40 border border-brand-depth rounded-xl text-brand-neutral-light focus:outline-none focus:border-brand-primary"})]})]}),s.exercise?.type==="cardio"&&e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-brand-neutral-light/80 mb-1",children:"Czas (min)"}),e.jsx("input",{type:"number",value:l,onChange:a=>g(Number(a.target.value)),className:"w-full px-3 py-2 bg-brand-neutral-dark/40 border border-brand-depth rounded-xl text-brand-neutral-light focus:outline-none focus:border-brand-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-brand-neutral-light/80 mb-1",children:"Dystans (km)"}),e.jsx("input",{type:"number",value:N,onChange:a=>w(Number(a.target.value)),className:"w-full px-3 py-2 bg-brand-neutral-dark/40 border border-brand-depth rounded-xl text-brand-neutral-light focus:outline-none focus:border-brand-primary"})]})]}),s.exercise?.type==="stretching"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-brand-neutral-light/80 mb-1",children:"Czas (min)"}),e.jsx("input",{type:"number",value:l,onChange:a=>g(Number(a.target.value)),className:"w-full px-3 py-2 bg-brand-neutral-dark/40 border border-brand-depth rounded-xl text-brand-neutral-light focus:outline-none focus:border-brand-primary"})]}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{type:"submit",className:"w-full py-2 bg-brand-accent-2 rounded-xl text-brand-neutral-light font-bold hover:bg-brand-accent-2/60 transition-all cursor-pointer",children:"Zapisz"})})]})]})})]})};function Q({entry:t,onRemoveEntry:f,onEdit:s}){const[j,x]=n.useState(!1),[h,o]=n.useState(!1),b=()=>x(!0),p=()=>x(!1),i=()=>{f(t.id)},l=[{label:"Klatka",value:"chest"},{label:"Plecy",value:"back"},{label:"Nogi",value:"legs"},{label:"Barki",value:"shoulders"},{label:"Ramiona",value:"arms"},{label:"Brzuch",value:"core"},{label:"Cardio",value:"cardio"}];return e.jsxs(e.Fragment,{children:[e.jsxs(y.div,{layout:!0,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"mb-2 last:mb-0 bg-brand-neutral-dark border border-brand-depth rounded-lg p-3 group relative overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-start z-10 relative",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-brand-neutral-light text-lg",children:t.exercise?.name||"Nieznane ćwiczenie"}),e.jsxs("p",{className:"text-sm text-brand-neutral-light/70 uppercase tracking-wider",children:[t.exercise?.type==="strength"?`${l.find(g=>g.value===t.exercise?.muscle_group)?.label} • `:"",t.exercise?.type==="strength"?"Siłowe":t.exercise?.type==="stretching"?"Rozciąganie":"Cardio"]})]}),e.jsxs("div",{className:"flex sm:flex-row flex-col gap-1",children:[e.jsx("button",{onClick:()=>o(!0),className:`flex sm:order-1 order-2 sm:w-auto h-fit items-center justify-center rounded-full text-sm text-brand-neutral-light \r
                        hover:bg-brand-neutral-light/10 hover:text-brand-neutral-light\r
                        transition-colors duration-200 cursor-pointer p-1`,title:"Edytuj",children:e.jsx(T,{className:"scale-75"})}),e.jsx("button",{onClick:b,className:`flex sm:order-2 order-1 sm:w-auto h-fit items-center justify-center rounded-full text-sm text-brand-neutral-light \r
                        hover:bg-red-800/20 hover:border-red-500/30 hover:text-red-400\r
                        transition-colors duration-200 cursor-pointer p-1`,title:"Usuń",children:e.jsx(D,{className:"scale-75"})})]})]}),e.jsx("div",{className:"mt-3 flex gap-4",children:t.exercise?.type==="strength"?e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"bg-brand-depth/30 rounded px-2 py-1",children:[e.jsx("span",{className:"text-brand-accent-1 font-bold",children:t.sets}),e.jsx("span",{className:"text-xs text-brand-neutral-light/50 ml-1",children:"SERIE"})]}),e.jsxs("div",{className:"bg-brand-depth/30 rounded px-2 py-1",children:[e.jsx("span",{className:"text-brand-accent-1 font-bold",children:t.reps}),e.jsx("span",{className:"text-xs text-brand-neutral-light/50 ml-1",children:"POWT."})]}),e.jsxs("div",{className:"bg-brand-depth/30 rounded px-2 py-1",children:[e.jsx("span",{className:"text-brand-accent-1 font-bold",children:t.weight_kg}),e.jsx("span",{className:"text-xs text-brand-neutral-light/50 ml-1",children:"KG"})]})]}):t.exercise?.type==="cardio"?e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"bg-brand-depth/30 rounded px-2 py-1",children:[e.jsx("span",{className:"text-brand-accent-1 font-bold",children:t.duration_min}),e.jsx("span",{className:"text-xs text-brand-neutral-light/50 ml-1",children:"MIN"})]}),e.jsxs("div",{className:"bg-brand-depth/30 rounded px-2 py-1",children:[e.jsx("span",{className:"text-brand-accent-1 font-bold",children:t.distance_km}),e.jsx("span",{className:"text-xs text-brand-neutral-light/50 ml-1",children:"KM"})]})]}):e.jsx("div",{className:"flex gap-2",children:e.jsxs("div",{className:"bg-brand-depth/30 rounded px-2 py-1",children:[e.jsx("span",{className:"text-brand-accent-1 font-bold",children:t.duration_min}),e.jsx("span",{className:"text-xs text-brand-neutral-light/50 ml-1",children:"MIN"})]})})})]}),e.jsx(I,{isOpen:j,onClose:p,onConfirm:i,description:e.jsxs("p",{children:["Czy na pewno chcesz usunąć"," ",e.jsx("strong",{className:"text-brand-neutral-light",children:t.exercise?.name||"ćwiczenie"}),"? Tej akcji nie można cofnąć."]})}),e.jsx(H,{isOpen:h,onClose:()=>o(!1),entry:t,onSave:s})]})}function Y({entries:t,onRemoveEntry:f,isLoading:s,onEdit:j}){return s?e.jsx("div",{className:"flex-1 bg-brand-neutral-dark/50 border border-brand-depth rounded-xl p-4 flex items-center justify-center",children:e.jsx("p",{className:"text-brand-neutral-light/50",children:"Ładowanie treningów..."})}):t.length===0?e.jsx("div",{className:"flex-1 bg-brand-neutral-dark/50 border border-brand-depth rounded-xl p-4 flex items-center justify-center",children:e.jsx("p",{className:"text-brand-neutral-light/50",children:"Brak treningów tego dnia"})}):e.jsx("div",{className:"flex-1 bg-brand-neutral-dark/50 border border-brand-depth rounded-xl p-4 overflow-y-auto custom-scrollbar",children:e.jsx(y.div,{className:"space-y-4",initial:"hidden",animate:"visible",variants:{visible:{transition:{staggerChildren:.05}}},children:e.jsx(C,{mode:"popLayout",children:t.map(x=>e.jsx(Q,{entry:x,onRemoveEntry:f,onEdit:j},x.id))})})})}function J(t,f=0){const[s,j]=n.useState(!1),[x,h]=n.useState([]),[o,b]=n.useState(null),[p,i]=n.useState(!0),{user:l}=_();return n.useEffect(()=>{const N=setTimeout(async()=>{j(!0),b(null);try{if(!t||t.length<2){if(!l){h([]),i(!0);return}const{data:w,error:c}=await S.from("workout_logs").select("exercise:exercises(*)").eq("user_id",l.id).order("created_at",{ascending:!1}).limit(50);if(c)throw c;const a=new Set,d=[];w?.forEach(m=>{m.exercise&&!a.has(m.exercise.id)&&(a.add(m.exercise.id),d.push(m.exercise))}),h(d.slice(0,7)),i(!0)}else{const{data:w,error:c}=await S.from("exercises").select("*").ilike("name",`%${t}%`).limit(20);if(c)throw c;h(w||[]),i(!1)}}catch(w){console.error("Error searching exercises:",w),b(w.message)}finally{j(!1)}},300);return()=>clearTimeout(N)},[t,l,f]),{loading:s,hits:x,error:o,isRecent:p}}function V({exercise:t,onCancel:f,onAdd:s,submitButtonText:j="Dodaj ćwiczenie",onEdit:x,onDelete:h}){const{user:o}=_(),[b,p]=n.useState(3),[i,l]=n.useState(10),[g,N]=n.useState(0),[w,c]=n.useState(0),[a,d]=n.useState(0),m=()=>{s({sets:t.type==="strength"||!t.type?b:1,reps:t.type==="strength"||!t.type?i:1,weight:t.type==="strength"||!t.type?g:0,duration:t.type==="cardio"||t.type==="stretching"?w:0,distance:t.type==="cardio"?a:0})},u="flex flex-col p-3 rounded-lg bg-brand-neutral-dark/40 backdrop-blur-md border border-brand-depth/50 shadow-inner",k=()=>{switch(t.type){case"cardio":return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:u,children:[e.jsx("label",{className:"text-xs font-bold text-brand-neutral-light/70 uppercase text-center mb-1",children:"Czas (min)"}),e.jsx("input",{type:"number",value:w,onChange:r=>c(Number(r.target.value)),className:"w-full bg-transparent text-center text-xl font-bold text-brand-accent-1 focus:outline-none",placeholder:"0"})]}),e.jsxs("div",{className:u,children:[e.jsx("label",{className:"text-xs font-bold text-brand-neutral-light/70 uppercase text-center mb-1",children:"Dystans (km)"}),e.jsx("input",{type:"number",value:a,onChange:r=>d(Number(r.target.value)),className:"w-full bg-transparent text-center text-xl font-bold text-brand-accent-1 focus:outline-none",placeholder:"0"})]})]});case"stretching":return e.jsxs("div",{className:`${u} col-span-full`,children:[e.jsx("label",{className:"text-xs font-bold text-brand-neutral-light/70 uppercase text-center mb-1",children:"Czas (min)"}),e.jsx("input",{type:"number",value:w,onChange:r=>c(Number(r.target.value)),className:"w-full bg-transparent text-center text-xl font-bold text-brand-accent-1 focus:outline-none",placeholder:"0"})]});case"strength":default:return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:u,children:[e.jsx("label",{className:"text-xs font-bold text-brand-neutral-light/70 uppercase text-center mb-1",children:"Serie"}),e.jsx("input",{type:"number",value:b,onChange:r=>p(Number(r.target.value)),className:"w-full bg-transparent text-center text-xl font-bold text-brand-accent-1 focus:outline-none"})]}),e.jsxs("div",{className:u,children:[e.jsx("label",{className:"text-xs font-bold text-brand-neutral-light/70 uppercase text-center mb-1",children:"Powtórzenia"}),e.jsx("input",{type:"number",value:i,onChange:r=>l(Number(r.target.value)),className:"w-full bg-transparent text-center text-xl font-bold text-brand-accent-1 focus:outline-none"})]}),e.jsxs("div",{className:u,children:[e.jsx("label",{className:"text-xs font-bold text-brand-neutral-light/70 uppercase text-center mb-1",children:"Ciężar (kg)"}),e.jsx("input",{type:"number",value:g,onChange:r=>N(Number(r.target.value)),className:"w-full bg-transparent text-center text-xl font-bold text-brand-accent-1 focus:outline-none"})]})]})}};return e.jsxs(y.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.2},className:"flex flex-col h-full p-4",children:[e.jsxs("div",{className:"flex items-start justify-between border-b border-brand-depth pb-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:f,className:`flex items-center justify-center p-2 hover:bg-brand-neutral-light/30 rounded-full transition-colors\r
                            text-brand-neutral-light/60 hover:text-brand-neutral-light cursor-pointer`,children:e.jsx(B,{className:"scale-95 rotate-180"})}),e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-brand-neutral-light",children:t.name})]}),e.jsx("p",{className:"text-xs text-brand-neutral-light/60 uppercase tracking-wider mt-1",children:t.type==="cardio"?"Cardio":t.type==="stretching"?"Rozciąganie":"Siłowe"}),t.description&&e.jsx("p",{className:"text-sm text-brand-neutral-light/70 mt-2 tracking-wide leading-relaxed",children:t.description})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[x&&o&&t.created_by===o.id&&e.jsx("button",{onClick:x,className:`flex items-center justify-center p-2 hover:bg-brand-accent-2/50 rounded-full transition-colors \r
                        text-brand-neutral-light/60 hover:text-brand-neutral-light cursor-pointer`,title:"Edytuj ćwiczenie",children:e.jsx(T,{className:"scale-95"})}),h&&o&&t.created_by===o.id&&e.jsx("button",{onClick:h,className:`flex items-center justify-center p-2 hover:bg-red-500/20 rounded-full transition-colors \r
                        text-brand-neutral-light/60 hover:text-red-400 cursor-pointer`,title:"Usuń ćwiczenie",children:e.jsx(L,{className:"scale-95"})})]})]}),e.jsx("div",{className:`flex flex-col gap-3 mb-6 md:grid ${t.type==="strength"||!t.type?"md:grid-cols-3":t.type==="cardio"?"md:grid-cols-2":"md:grid-cols-1"}`,children:k()}),e.jsx(y.button,{onClick:m,whileHover:{scale:1.02},whileTap:{scale:.98},className:`mt-auto w-full py-4 bg-brand-accent-1 hover:bg-brand-accent-2 cursor-pointer text-white font-bold rounded-xl \r
                   shadow-lg hover:shadow-brand-accent-1/20 transition-all flex items-center justify-center gap-2 text-lg`,children:j})]},"details")}function U({onAddExercise:t,submitButtonText:f="Dodaj ćwiczenie",onCreateExercise:s,onEditExercise:j,onDeleteExercise:x,refreshTrigger:h=0}){const[o,b]=n.useState(""),{loading:p,hits:i,error:l,isRecent:g}=J(o,h),[N,w]=n.useState(null);n.useEffect(()=>{(async()=>{if(N&&h>0){const{data:d,error:m}=await S.from("exercises").select("*").eq("id",N.id).single();w(d&&!m?d:null)}})()},[h]);const c=a=>{N&&(t(N,a),w(null),b(""))};return e.jsx("div",{className:"flex flex-col h-full bg-brand-neutral-dark/50 rounded-b-xl overflow-hidden border border-brand-depth/50",children:e.jsx(C,{mode:"wait",children:N?e.jsx(V,{exercise:N,onCancel:()=>w(null),onAdd:c,submitButtonText:f,onEdit:j?()=>j(N):void 0,onDelete:x?()=>x(N):void 0}):e.jsxs(y.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},className:"flex flex-col h-full",children:[e.jsxs("div",{className:"p-3 border-b border-brand-depth bg-brand-neutral-dark relative flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(E,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-brand-neutral-light/50"}),e.jsx("input",{type:"text",placeholder:"Szukaj ćwiczenia...",value:o,onChange:a=>b(a.target.value),className:`w-full pl-10 pr-4 py-3 rounded-lg bg-brand-depth/30 border border-brand-depth/50 text-brand-neutral-light \r
                            placeholder-brand-neutral-light/30 focus:outline-none focus:ring-1 focus:ring-brand-accent-1 focus:border-brand-accent-1 \r
                            transition-all`})]}),e.jsx("button",{onClick:s,className:"bg-brand-accent-1 hover:bg-brand-accent-2 text-white p-3 rounded-lg transition-colors shadow-lg cursor-pointer",title:"Stwórz nowe ćwiczenie",children:"+"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-2 space-y-1 relative",children:[e.jsx(C,{children:p&&o.length>=2&&e.jsx(y.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-10 flex items-center justify-center bg-brand-neutral-dark/60 backdrop-blur-xs",children:e.jsx("p",{className:"text-brand-neutral-light/70 font-medium animate-pulse",children:"Szukanie..."})})}),l&&e.jsxs("p",{className:"text-red-400 text-center py-4 text-sm",children:["Błąd: ",l]}),i.map(a=>e.jsx(y.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>w(a),className:`p-4 rounded-lg bg-brand-neutral-dark border 
                            cursor-pointer transition-colors group shadow-sm hover:shadow-md hover:border-brand-accent-3/30
                            hover:bg-brand-neutral-dark/90 ${g?"border-brand-accent-1/20 bg-brand-accent-1/5":"border-brand-depth/50"}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:`font-medium text-brand-neutral-light group-hover:text-brand-accent-3 \r
                                    transition-colors truncate flex-1 min-w-0 mr-2`,children:a.name}),(()=>{let d=a.type,m="text-brand-neutral-dark/80 bg-brand-depth";return a.type==="strength"?d=[{label:"Klatka",value:"chest"},{label:"Plecy",value:"back"},{label:"Nogi",value:"legs"},{label:"Barki",value:"shoulders"},{label:"Ramiona",value:"arms"},{label:"Brzuch",value:"core"},{label:"Cardio",value:"cardio"}].find(k=>k.value===a.muscle_group)?.label||a.muscle_group:a.type==="cardio"?(d="Cardio",m="bg-brand-accent-1 text-brand-neutral-darker"):a.type==="stretching"&&(d="Rozciąganie",m="bg-brand-accent-2 text-brand-neutral-darker"),e.jsx("span",{className:`text-xs font-bold px-2 py-1 rounded-full uppercase tracking-wide ${m}`,children:d})})()]})},a.id)),!p&&!g&&i.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-brand-neutral-light/40",children:[e.jsx(E,{className:"text-4xl mb-2 opacity-20"}),e.jsx("p",{className:"text-sm",children:"Brak wyników"})]}),!p&&g&&i.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-brand-neutral-light/30",children:[e.jsx(E,{className:"text-5xl mb-3"}),e.jsx("p",{className:"text-sm",children:"Wpisz nazwę aby wyszukać"}),e.jsx("button",{onClick:s,className:"mt-2 text-brand-accent-1 hover:underline cursor-pointer text-sm",children:"lub stwórz nowe ćwiczenie"})]})]})]},"search")})})}function O(t,f=0){const{user:s}=_(),[j,x]=n.useState(!1),[h,o]=n.useState([]),[b,p]=n.useState(null),i=async()=>{if(s){x(!0),p(null);try{let c=S.from("workout_sets").select(`
          *,
          items:workout_set_items (
            *,
            exercise:exercises (*)
          )
        `).order("created_at",{ascending:!1});t&&(c=c.ilike("name",`%${t}%`));const{data:a,error:d}=await c;if(d)throw d;o(a||[])}catch(c){console.error("Error searching sets:",c),p(c.message)}finally{x(!1)}}};n.useEffect(()=>{const c=setTimeout(i,300);return()=>clearTimeout(c)},[t,s,f]);const l=()=>{i()};return{loading:j,sets:h,error:b,refreshSets:l,createSet:async(c,a,d)=>{if(!s)throw new Error("Użytkownik nie jest zalogowany");const{data:m,error:u}=await S.from("workout_sets").insert({name:c,description:a,created_by:s.id}).select().single();if(u)throw u;if(d.length>0){const k=d.map((v,z)=>({set_id:m.id,exercise_id:v.exercise.id,order_index:z,sets:v.sets,reps:v.reps,weight_kg:v.weight,duration_min:v.duration})),{error:r}=await S.from("workout_set_items").insert(k);if(r)throw r}return l(),m},deleteSet:async c=>{const{error:a}=await S.from("workout_sets").delete().eq("id",c);if(a)throw a;l()},updateSet:async(c,a,d,m)=>{if(!s)throw new Error("Użytkownik nie jest zalogowany");const{error:u}=await S.from("workout_sets").update({name:a,description:d}).eq("id",c);if(u)throw u;const{error:k}=await S.from("workout_set_items").delete().eq("set_id",c);if(k)throw k;if(m.length>0){const r=m.map((z,R)=>({set_id:c,exercise_id:z.exercise.id,order_index:R,sets:z.sets,reps:z.reps,weight_kg:z.weight,duration_min:z.duration})),{error:v}=await S.from("workout_set_items").insert(r);if(v)throw v}l()}}}function W({onClose:t,onSuccess:f,initialData:s}){const{createSet:j,updateSet:x}=O(""),[h,o]=n.useState("details"),[b,p]=n.useState(s?.name||""),[i,l]=n.useState(s?.description||""),[g,N]=n.useState([]),[w,c]=n.useState(!1),[a,d]=n.useState(null);n.useEffect(()=>{s?.items&&N(s.items.map(r=>({id:r.id||Math.random().toString(36).substr(2,9),exercise:r.exercise,sets:r.sets,reps:r.reps,weight:r.weight_kg||0,duration:r.duration_min||0,distance:r.distance_km||0})))},[s]);const m=(r,v)=>{const z={id:Math.random().toString(36).substr(2,9),exercise:r,sets:v.sets,reps:v.reps,weight:v.weight,duration:v.duration,distance:v.distance};N(R=>[...R,z]),o("details")},u=r=>{N(v=>v.filter(z=>z.id!==r))},k=async()=>{if(!b.trim()){d("Nazwa zestawu jest wymagana");return}if(g.length===0){d("Dodaj przynajmniej jedno ćwiczenie");return}c(!0),d(null);try{s?await x(s.id,b,i,g):await j(b,i,g),f(),t()}catch(r){console.error("Failed to save set:",r),d("Nie udało się zapisać zestawu: "+r.message)}finally{c(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-brand-neutral-dark/60",children:e.jsxs(y.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:`bg-brand-neutral-dark border border-brand-depth w-full max-w-lg h-[80vh] rounded-2xl \r
                  shadow-2xl flex flex-col overflow-hidden`,children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-brand-depth bg-brand-neutral-dark/50",children:[e.jsx("h2",{className:"text-xl font-bold text-brand-neutral-light",children:h==="details"?s?"Edytuj zestaw ćwiczeń":"Stwórz nowy zestaw ćwiczeń":"Dodaj ćwiczenie do zestawu"}),e.jsx("button",{onClick:h==="details"?t:()=>o("details"),className:`p-1 cursor-pointer hover:bg-brand-depth rounded-full transition-colors hover:text-brand-neutral-dark \r
                    text-brand-neutral-light flex items-center justify-center`,children:e.jsx(M,{})})]}),e.jsx("div",{className:"flex-1 overflow-hidden relative",children:e.jsx(C,{mode:"wait",children:h==="details"?e.jsxs(y.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},className:"flex flex-col h-full p-4 overflow-y-auto custom-scrollbar",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-brand-neutral-light/70 uppercase mb-1",children:"Nazwa zestawu"}),e.jsx("input",{type:"text",value:b,onChange:r=>p(r.target.value),placeholder:"np. Rozgrzewka A",className:`w-full px-4 py-2 rounded-lg bg-brand-depth/30 border border-brand-depth/50 text-brand-neutral-light \r
                                focus:outline-none focus:border-brand-accent-1 transition-colors`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-brand-neutral-light/70 uppercase mb-1",children:"Opis (opcjonalnie)"}),e.jsx("textarea",{value:i,onChange:r=>l(r.target.value),placeholder:"Krótki opis zestawu...",rows:2,className:`w-full px-4 py-2 rounded-lg bg-brand-depth/30 border border-brand-depth/50 text-brand-neutral-light \r
                                focus:outline-none focus:border-brand-accent-1 resize-none transition-colors`})]}),e.jsxs("div",{className:"pt-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("label",{className:"block text-xs font-bold text-brand-neutral-light/70 uppercase",children:["Ćwiczenia (",g.length,")"]}),e.jsx("button",{onClick:()=>o("add-exercise"),className:`text-xs font-bold text-brand-accent-1 hover:text-brand-accent-2 cursor-pointer transition-colors \r
                                  uppercase tracking-wide`,children:"+ Dodaj ćwiczenie"})]}),e.jsxs("div",{className:"space-y-2 min-h-[100px] bg-brand-depth/10 rounded-lg p-2 border border-brand-depth/30",children:[g.length===0&&e.jsx("p",{className:"text-center text-brand-neutral-light/30 text-sm py-8",children:"Brak ćwiczeń. Dodaj pierwsze ćwiczenie!"}),g.map((r,v)=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-brand-neutral-dark border border-brand-depth rounded-lg group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-brand-neutral-light/30 font-bold text-xs w-4",children:[v+1,"."]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-brand-neutral-light",children:r.exercise.name}),e.jsx("p",{className:"text-xs text-brand-neutral-light/60",children:r.exercise.type==="cardio"?`${r.duration} min | ${r.distance} km`:r.exercise.type==="stretching"?`${r.duration} min`:`${r.sets} x ${r.reps} ${r.weight>0?`| ${r.weight}kg`:""}`})]})]}),e.jsx("button",{onClick:()=>u(r.id),className:`text-brand-neutral-light/30 hover:text-red-400 transition-colors p-1 hover:bg-red-400/10 \r
                                      flex items-center justify-center rounded-full cursor-pointer`,children:e.jsx(D,{})})]},r.id))]})]}),a&&e.jsx("p",{className:"text-red-400 text-sm text-center bg-red-400/10 p-2 rounded",children:a})]}),e.jsx("div",{className:"mt-auto pt-4",children:e.jsx("button",{onClick:k,disabled:w,className:`w-full py-3 bg-brand-accent-1 hover:bg-brand-accent-2 disabled:opacity-50 disabled:cursor-not-allowed\r
                             text-white font-bold rounded-xl shadow-lg transition-all cursor-pointer`,children:w?"Zapisywanie...":s?"Zapisz zmiany":"Utwórz zestaw"})})]},"details"):e.jsx(y.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.2},className:"flex flex-col h-full",children:e.jsx(U,{onAddExercise:m,submitButtonText:"Dodaj do zestawu"})},"add-exercise")})})]})})}function X({onAddSet:t,onCreateSet:f,refreshTrigger:s=0}){const[j,x]=n.useState(""),{loading:h,sets:o,error:b,refreshSets:p,deleteSet:i}=O(j,s),[l,g]=n.useState(null),[N,w]=n.useState(!1),[c,a]=n.useState(!1),d=()=>{l&&(t(l),g(null),x(""))},m=async()=>{if(l)try{await i(l.id),g(null),a(!1)}catch(u){console.error("Failed to delete set",u)}};return e.jsxs("div",{className:"flex flex-col h-full bg-brand-neutral-dark/50 rounded-b-xl overflow-hidden border border-brand-depth/50",children:[e.jsx(C,{mode:"wait",children:l?e.jsxs(y.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.2},className:"flex flex-col h-full p-4",children:[e.jsxs("div",{className:"flex items-start justify-between border-b border-brand-depth pb-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>g(null),className:`flex items-center justify-center p-2 hover:bg-brand-neutral-light/30 rounded-full transition-colors \r
                        text-brand-neutral-light/60 hover:text-brand-neutral-light cursor-pointer`,title:"Wróć",children:e.jsx(B,{className:"scale-95 rotate-180"})}),e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-brand-neutral-light",children:l.name})]}),e.jsxs("p",{className:"text-xs text-brand-neutral-light/60 uppercase tracking-wider mt-1",children:["Liczba ćwiczeń: ",l.items?.length||0]}),e.jsx("p",{className:"text-sm text-brand-neutral-light/70 mt-2 tracking-wide leading-relaxed",children:l.description})]}),e.jsx("div",{className:"flex flex-col items-end gap-2",children:e.jsxs("div",{className:"ml-4 flex sm:flex-row flex-col gap-2",children:[e.jsx("button",{onClick:()=>w(!0),className:`flex items-center justify-center p-2 hover:bg-brand-accent-2/50 rounded-full transition-colors \r
                        text-brand-neutral-light/60 hover:text-brand-neutral-light cursor-pointer`,title:"Edytuj zestaw",children:e.jsx(T,{className:"scale-95"})}),e.jsx("button",{onClick:()=>a(!0),className:`flex items-center justify-center p-2 hover:bg-red-400/50 rounded-full transition-colors \r
                    text-brand-neutral-light/60 hover:text-brand-neutral-light cursor-pointer`,title:"Usuń zestaw",children:e.jsx(L,{className:"scale-95"})})]})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto mb-4 custom-scrollbar",children:e.jsx("div",{className:"space-y-2",children:l.items?.map((u,k)=>e.jsx("div",{className:"p-3 rounded bg-brand-depth/20 border border-brand-depth/40 flex justify-between items-center",children:e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsxs("span",{className:"text-brand-neutral-light/30 font-bold text-xs w-4",children:[k+1,"."]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-brand-neutral-light font-medium text-sm",children:u.exercise?.name}),e.jsx("p",{className:"text-brand-neutral-light/60 text-xs",children:u.exercise?.type==="strength"?`${u.sets} x ${u.reps} • ${u.weight_kg||0}kg`:`${u.sets} serii • ${u.duration_min||u.reps} min/powt`})]})]})},u.id))})}),e.jsx(y.button,{onClick:d,whileHover:{scale:1.02},whileTap:{scale:.98},className:`mt-auto w-full py-3.5 bg-brand-accent-1 hover:bg-brand-accent-2 cursor-pointer text-white font-bold rounded-xl \r
                         shadow-lg hover:shadow-brand-accent-1/20 transition-all flex items-center justify-center gap-2`,children:"Dodaj zestaw treningowy"})]},"details"):e.jsxs(y.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},className:"flex flex-col h-full",children:[e.jsxs("div",{className:"p-3 border-b border-brand-depth bg-brand-neutral-dark relative flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(E,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-brand-neutral-light/50"}),e.jsx("input",{type:"text",placeholder:"Szukaj zestawu...",value:j,onChange:u=>x(u.target.value),className:`w-full pl-10 pr-4 py-3 rounded-lg bg-brand-depth/30 border border-brand-depth/50 text-brand-neutral-light \r
                            placeholder-brand-neutral-light/30 focus:outline-none focus:ring-1 focus:ring-brand-accent-1 focus:border-brand-accent-1 \r
                            transition-all`})]}),e.jsx("button",{onClick:f,className:"bg-brand-accent-1 hover:bg-brand-accent-2 text-white p-3 rounded-lg transition-colors shadow-lg",title:"Stwórz nowy zestaw",children:"+"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-2 space-y-2",children:[h&&e.jsx("p",{className:"text-brand-neutral-light/50 text-center py-8 text-sm animate-pulse",children:"Ładowanie..."}),b&&e.jsxs("p",{className:"text-red-400 text-center py-4 text-sm",children:["Błąd: ",b]}),o.map(u=>e.jsx(y.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>g(u),className:`p-4 rounded-lg bg-brand-neutral-dark border border-brand-depth/50 \r
                            cursor-pointer transition-colors group shadow-sm hover:shadow-md hover:border-brand-accent-3/30\r
                            hover:bg-brand-neutral-dark/90`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-brand-neutral-light group-hover:text-brand-accent-3 transition-colors",children:u.name}),u.description&&e.jsx("p",{className:"text-xs text-brand-neutral-light/50 mt-1 line-clamp-1",children:u.description})]}),e.jsxs("span",{className:"text-xs font-bold text-brand-neutral-dark/80 bg-brand-depth px-2 py-1 rounded-full uppercase tracking-wide whitespace-nowrap",children:[u.items?.length||0," ćw."]})]})},u.id)),!h&&j&&o.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-brand-neutral-light/40",children:[e.jsx(E,{className:"text-4xl mb-2 opacity-20"}),e.jsx("p",{className:"text-sm",children:"Brak wyników"})]}),!h&&!j&&o.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-brand-neutral-light/30",children:[e.jsx(E,{className:"text-5xl mb-3"}),e.jsx("p",{className:"text-sm",children:"Brak zestawów"}),e.jsx("button",{onClick:f,className:"mt-2 text-brand-accent-1 hover:underline cursor-pointer text-sm",children:"Stwórz swój pierwszy zestaw"})]})]})]},"search")}),N&&l&&e.jsx(W,{initialData:l,onClose:()=>w(!1),onSuccess:()=>{p(),g(null),w(!1)}}),e.jsx(I,{isOpen:c,onClose:()=>a(!1),onConfirm:m,title:"Usuń zestaw",description:e.jsxs("p",{children:["Czy na pewno chcesz usunąć zestaw"," ",e.jsx("strong",{className:"text-brand-neutral-light",children:l?.name}),"?"]})})]})}const ee=[{label:"Klatka",value:"chest"},{label:"Plecy",value:"back"},{label:"Nogi",value:"legs"},{label:"Barki",value:"shoulders"},{label:"Ramiona",value:"arms"},{label:"Brzuch",value:"core"},{label:"Cardio",value:"cardio"}],te=[{label:"Siłowe",value:"strength"},{label:"Cardio",value:"cardio"},{label:"Rozciąganie",value:"stretching"}];function se({onClose:t,onCreated:f,initialData:s}){const{user:j}=_(),[x,h]=n.useState(s?.name||""),[o,b]=n.useState(s?.description||""),[p,i]=n.useState(s?.muscle_group||"chest"),[l,g]=n.useState(s?.type||"strength"),[N,w]=n.useState(!1),[c,a]=n.useState(null);n.useEffect(()=>{s?(h(s.name),b(s.description||""),i(s.muscle_group),g(s.type)):(h(""),b(""),i("chest"),g("strength"))},[s]);const d=async m=>{if(m.preventDefault(),!j||!x)return;w(!0),a(null);const u={name:x,description:o,muscle_group:l==="strength"?p:l,type:l};let k=null;if(s){const{data:r,error:v}=await S.from("exercises").update(u).eq("id",s.id).select();v?k=v:(!r||r.length===0)&&(k={message:"Brak uprawnień do edycji tego ćwiczenia lub ćwiczenie nie istnieje."})}else{const{error:r}=await S.from("exercises").insert({...u,created_by:j.id});k=r}w(!1),k?(console.error(`Error ${s?"updating":"creating"} custom exercise`,k),a(`Nie udało się ${s?"zaktualizować":"utworzyć"} ćwiczenia: `+k.message)):(s||(h(""),b("")),f(),t())};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-brand-neutral-dark/60",children:e.jsxs(y.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:`bg-brand-neutral-dark border border-brand-depth w-full max-w-lg rounded-2xl \r
                  shadow-2xl flex flex-col`,children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-brand-depth bg-brand-neutral-dark/50 rounded-t-2xl",children:[e.jsx("h2",{className:"text-xl font-bold text-brand-neutral-light",children:s?"Edytuj ćwiczenie":"Stwórz własne ćwiczenie"}),e.jsx("button",{onClick:t,className:`p-1 cursor-pointer hover:bg-brand-depth rounded-full transition-colors hover:text-brand-neutral-dark \r
                    text-brand-neutral-light flex items-center justify-center`,children:e.jsx(M,{})})]}),e.jsxs("form",{onSubmit:d,className:"flex flex-col gap-5 p-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm text-brand-neutral-light font-medium",children:"Nazwa ćwiczenia"}),e.jsx("input",{type:"text",value:x,onChange:m=>h(m.target.value),required:!0,placeholder:"np. Wyciskanie hantli",className:`p-3 rounded-lg bg-brand-neutral-dark border border-brand-depth text-brand-neutral-light \r
                         placeholder-brand-neutral-light/30 focus:outline-none focus:ring-1 focus:ring-brand-accent-1 \r
                         focus:border-brand-accent-1 transition-all`})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm text-brand-neutral-light font-medium",children:"Opis (opcjonalnie)"}),e.jsx("textarea",{value:o,onChange:m=>b(m.target.value),placeholder:"Krótki opis, wskazówki...",rows:2,className:`p-3 rounded-lg bg-brand-neutral-dark border border-brand-depth text-brand-neutral-light \r
                         placeholder-brand-neutral-light/30 focus:outline-none focus:ring-1 focus:ring-brand-accent-1 \r
                         focus:border-brand-accent-1 transition-all resize-none`})]}),e.jsxs("div",{className:`grid grid-cols-1 ${l==="strength"?"sm:grid-cols-2":""} gap-4`,children:[l==="strength"&&e.jsx(P,{label:"Partia mięśniowa",value:p,onChange:i,options:ee}),e.jsx(P,{label:"Typ",value:l,onChange:m=>g(m),options:te})]}),c&&e.jsx("p",{className:"text-red-400 text-sm text-center bg-red-400/10 p-2 rounded",children:c}),e.jsx(y.button,{type:"submit",disabled:N,whileHover:{scale:1.02},whileTap:{scale:.98},className:`mt-4 w-full py-3 bg-brand-accent-1 hover:bg-brand-accent-2 text-white font-bold rounded-lg \r
                       transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg \r
                       cursor-pointer hover:shadow-brand-accent-1/20`,children:N?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"animate-spin"})," Zapisywanie..."]}):s?"Zapisz zmiany":"Stwórz ćwiczenie"})]})]})})}function re({onAddExercise:t}){const[f,s]=n.useState("exercises"),[j,x]=n.useState(!1),[h,o]=n.useState(void 0),[b,p]=n.useState(!1),[i,l]=n.useState(0),[g,N]=n.useState(0),[w,c]=n.useState(!1),[a,d]=n.useState(null),m=r=>{r.items?.forEach(v=>{v.exercise&&t(v.exercise,{sets:v.sets,reps:v.reps,weight:v.weight_kg||0,duration:v.duration_min||0,distance:v.distance_km||0})})},u=r=>{d(r),c(!0)},k=async()=>{if(!a)return;const{error:r}=await S.from("exercises").delete().eq("id",a.id);r?(console.error("Error deleting exercise:",r),alert("Wystąpił błąd podczas usuwania ćwiczenia: "+r.message)):l(v=>v+1),c(!1),d(null)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-xl flex-1 flex flex-col min-h-0",children:[e.jsxs("div",{className:"flex border-b border-brand-depth gap-2",children:[e.jsx($,{label:"Ćwiczenia",value:"exercises",isSelected:f==="exercises",setSelectedTab:r=>s(r)}),e.jsx($,{label:"Zestawy",value:"sets",isSelected:f==="sets",setSelectedTab:r=>s(r)})]}),f==="exercises"?e.jsx("div",{className:"flex flex-col h-full overflow-hidden",children:e.jsx("div",{className:"flex-1 overflow-hidden relative",children:e.jsx(C,{mode:"wait",children:e.jsx(U,{onAddExercise:t,onCreateExercise:()=>{o(void 0),p(!0)},onEditExercise:r=>{o(r),p(!0)},onDeleteExercise:u,refreshTrigger:i},"search")})})}):e.jsx("div",{className:"flex-1 overflow-hidden relative",children:e.jsx(X,{onCreateSet:()=>x(!0),onAddSet:m,refreshTrigger:g})})]}),e.jsxs(C,{children:[j&&e.jsx(W,{onClose:()=>x(!1),onSuccess:()=>{N(r=>r+1),x(!1)}}),b&&e.jsx(se,{onClose:()=>{p(!1),o(void 0)},initialData:h,onCreated:()=>{l(r=>r+1),p(!1),o(void 0)}})]}),e.jsx(I,{isOpen:w,onClose:()=>c(!1),onConfirm:k,title:"Usuń ćwiczenie",description:e.jsxs("p",{children:["Czy na pewno chcesz usunąć ćwiczenie"," ",e.jsx("strong",{className:"text-brand-neutral-light",children:a?.name}),"? ",e.jsx("br",{}),e.jsx("span",{className:"text-xs opacity-80 mt-2 block",children:"Usunie to również wszystkie użycia tego ćwiczenia w historii treningów oraz zestawach. Tego działania nie można cofnąć."})]})})]})}const ae=[{id:1,name:"Poniedziałek"},{id:2,name:"Wtorek"},{id:3,name:"Środa"},{id:4,name:"Czwartek"},{id:5,name:"Piątek"},{id:6,name:"Sobota"},{id:0,name:"Niedziela"}];function ne({onClose:t}){const{weeklyPlan:f,updateScheduledDay:s,loading:j}=A(),{sets:x,loading:h,refreshSets:o}=O("");return n.useEffect(()=>{o()},[]),e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs(y.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-brand-neutral-dark border border-brand-depth rounded-2xl w-full max-w-2xl max-h-[90vh] flex flex-col shadow-2xl",children:[e.jsxs("div",{className:"p-6 border-b border-brand-depth flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl lg:text-2xl font-bold text-brand-neutral-light",children:"Plan tygodniowy"}),e.jsx("button",{onClick:t,className:`flex items-center justify-center p-2 hover:bg-brand-depth/50 rounded-full transition-colors \r
                text-brand-neutral-light/60 hover:text-brand-neutral-light cursor-pointer`,children:e.jsx(M,{})})]}),e.jsx("div",{className:"p-6 overflow-y-auto custom-scrollbar space-y-4",children:j||h?e.jsx("div",{className:"py-10 text-center text-brand-neutral-light/50",children:"Ładowanie..."}):e.jsx("div",{className:"grid grid-cols-1 gap-3",children:ae.map(b=>{const p=f.find(i=>i.scheduled_day===b.id);return e.jsxs("div",{className:"flex items-center gap-4 bg-brand-depth/20 p-3 rounded-xl border border-brand-depth/40 hover:border-brand-depth transition-colors",children:[e.jsx("div",{className:"truncate w-14 lg:w-28 font-medium text-brand-neutral-light",children:b.name}),e.jsx("div",{className:"flex-1",children:e.jsxs("select",{value:p?.id||"",onChange:i=>{const l=i.target.value;!l&&p?s(p.id,null):l&&s(l,b.id)},className:`w-full bg-brand-neutral-dark border border-brand-depth/60 rounded-lg px-3 py-2 text-sm text-brand-neutral-light focus:border-brand-accent-1 \r
                                focus:ring-1 focus:ring-brand-accent-1 outline-none`,children:[e.jsx("option",{value:"",children:"Brak planu"}),x.map(i=>e.jsx("option",{value:i.id,children:i.name},i.id))]})})]},b.id)})})}),e.jsx("div",{className:"p-6 border-t border-brand-depth flex justify-end",children:e.jsx("button",{onClick:t,className:"px-6 py-2 bg-brand-accent-1 hover:bg-brand-accent-2 text-white font-bold rounded-xl transition-all shadow-lg cursor-pointer",children:"Gotowe"})})]})})}function le({entries:t,selectedDate:f}){const[s,j]=n.useState(!1),{getDayPlan:x,refreshPlan:h}=A(),[o,b]=n.useState(null),p=n.useMemo(()=>{const l=f.getDay();return l===0?0:l},[f]);n.useEffect(()=>{h()},[]),n.useEffect(()=>{const l=x(p);b(l)},[p,x]);const i=n.useMemo(()=>{const l=new Set(t.map(a=>a.exercise_id)).size,g=t.reduce((a,d)=>a+(d.sets||0),0),N=t.reduce((a,d)=>a+(d.sets||0)*(d.reps||0)*(d.weight_kg||0),0),w=t.reduce((a,d)=>a+(d.distance_km||0),0),c=t.length>0?t[0]:null;return{workouts:l,sets:g,volume:N,distance_km:w,lastSet:c}},[t]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-brand-neutral-dark/40 border border-brand-depth rounded-2xl p-6 relative",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs(y.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4},className:"bg-brand-neutral-dark p-4 border border-brand-depth rounded-xl h-full flex flex-col justify-center min-h-[100px]",children:[e.jsx("p",{className:"text-xs text-brand-neutral-light/70 uppercase tracking-wide mb-2",children:"Ostatnia seria"}),i.lastSet?e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-lg font-bold text-brand-neutral-light line-clamp-1",children:i.lastSet.exercise?.name||"Nieznane ćwiczenie"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-xs text-brand-accent-1 bg-brand-accent-1/10 px-2 py-0.5 rounded",children:new Date(i.lastSet.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),e.jsxs("span",{className:"text-sm text-brand-secondary",children:[i.lastSet.weight_kg," kg x ",i.lastSet.reps]})]})]}):e.jsx("span",{className:"text-brand-neutral-light/50 italic text-sm",children:"Brak aktywności"})]}),e.jsx(y.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4},className:"bg-brand-neutral-dark p-4 border border-brand-depth rounded-xl h-full flex flex-col justify-center min-h-[100px]",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-xs text-brand-neutral-light/60 uppercase tracking-widest mb-1",children:[f.toLocaleDateString("pl-PL",{weekday:"long"}),": PLAN"]}),e.jsx("button",{onClick:()=>j(!0),className:`flex items-center justify-center text-brand-neutral-light hover:text-white transition-all hover:bg-brand-depth/50 \r
                            p-1 rounded-full cursor-pointer`,title:"Zmień plan",children:e.jsx(T,{className:"scale-80"})})]}),o?e.jsxs("div",{className:"text-center px-6",children:[e.jsx("h3",{className:"text-xl lg:text-2xl font-bold text-brand-accent-2 mb-2 line-clamp-2",children:o.name}),e.jsxs("span",{className:"text-xs text-brand-neutral-light/50 bg-brand-depth/50 px-2 py-1 rounded-full",children:["Liczba ćwiczeń: ",o.items?.length||0]})]}):e.jsx("span",{className:"text-brand-neutral-light/30 italic px-4 text-center",children:"Brak planu"})]})}),e.jsx(y.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},className:"bg-brand-neutral-dark p-4 border border-brand-depth rounded-xl flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-brand-neutral-light/70 uppercase tracking-wide mb-1",children:"Ćwiczenia • Serie"}),e.jsxs("p",{className:"text-2xl font-bold text-brand-accent-1",children:[i.workouts," ",e.jsx("span",{className:"text-brand-neutral-light/50",children:"•"})," ",e.jsx("span",{className:"text-brand-accent-3",children:i.sets})]})]})}),e.jsx(y.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},className:"bg-brand-neutral-dark p-4 border border-brand-depth rounded-xl flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-brand-neutral-light/70 uppercase tracking-wide mb-1",children:"Objętość • Przebieg"}),e.jsxs("p",{className:"text-2xl font-bold text-brand-accent-1",children:[e.jsxs("span",{className:"text-brand-accent-3",children:[i.volume," kg"]})," ",e.jsx("span",{className:"text-brand-neutral-light/50",children:"•"})," ",e.jsxs("span",{className:"text-brand-accent-1",children:[i.distance_km," km"]})]})]})})]})}),e.jsx(C,{children:s&&e.jsx(ne,{onClose:()=>j(!1)})})]})}function he(){_();const[t,f]=n.useState(new Date),{entries:s,isLoading:j,addEntry:x,removeEntry:h,editEntry:o}=Z(t),b=async(i,l)=>{await x(i,l)},p=async i=>{await h(i)};return e.jsxs(y.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"flex flex-col lg:flex-row gap-6 py-2 sm:py-4 h-full lg:h-[calc(100vh-1rem)] w-full overflow-hidden",children:[e.jsxs("div",{className:"lg:w-1/3 w-full h-full flex flex-col gap-4 overflow-hidden order-1",children:[e.jsx(K,{selectedDate:t,onDateChange:f,format:"day"}),e.jsx(Y,{entries:s,onRemoveEntry:p,isLoading:j,onEdit:o})]}),e.jsxs("div",{className:"lg:w-2/3 w-full h-full flex flex-col gap-4 overflow-hidden order-1 lg:order-2",children:[e.jsx(le,{entries:s,selectedDate:t}),e.jsx(re,{onAddExercise:b})]})]})}export{he as default};
