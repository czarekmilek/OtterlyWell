import{j as e,Q as Y,F as q,i as R,r as m,z as G,K as H,l as U,O as E,k as J,D as Q}from"./index-1dX7M82B.js";import{a as $,F as V,u as X}from"./FinanceIOPeek-HKQyZVaS.js";import{C as ee,A as te}from"./ConfirmDeleteDialog-BlCcLmEk.js";import{m as _}from"./proxy-IKh-44iE.js";import{T as M}from"./TabButton-BktLqMPx.js";import{D as ne}from"./DateSelector-CgO7mwVk.js";function se({type:t,onClose:s}){return e.jsxs("div",{className:"bg-brand-neutral-dark border-b border-brand-depth px-4 py-3 sm:px-6 flex justify-between items-center",children:[e.jsxs(Y,{as:"h3",className:"text-lg font-semibold leading-6 text-brand-neutral-light flex items-center gap-2",children:[e.jsx(q,{className:"text-brand-accent-1"}),t==="income"?"Dodaj przychód":"Dodaj wydatek"]}),e.jsx("button",{type:"button",onClick:s,className:`text-brand-secondary hover:text-brand-neutral-dark hover:bg-brand-neutral-light/70 rounded-full \r
                  p-1 flex items-center justify-center cursor-pointer transition-all`,children:e.jsx(R,{})})]})}function re({type:t,setType:s}){return e.jsxs("div",{className:"flex rounded-md bg-brand-neutral-dark/50 p-1 border border-brand-depth",children:[e.jsx("button",{type:"button",onClick:()=>s("expense"),className:`flex-1 py-1.5 text-sm font-medium rounded ${t==="expense"?"bg-brand-negative/20 text-brand-negative shadow-sm":"text-brand-secondary hover:text-brand-neutral-light cursor-pointer"}`,children:"Wydatek"}),e.jsx("button",{type:"button",onClick:()=>s("income"),className:`flex-1 py-1.5 text-sm font-medium rounded ${t==="income"?"bg-brand-positive-lighter/20 text-brand-positive-lighter shadow-sm":"text-brand-secondary hover:text-brand-neutral-light cursor-pointer"}`,children:"Przychód"})]})}const Z=m.forwardRef(({isOpen:t,onClose:s,onSubmit:l,categories:c,initialType:x="expense",initialData:i},h)=>{const[p,f]=m.useState(i?.type||x),[d,u]=m.useState(i?.amount.toString()||""),[N,y]=m.useState(i?.title||""),[a,w]=m.useState(i?.description||""),[j,v]=m.useState(i?.category_id||""),[C,z]=m.useState(i?.date||new Date().toISOString().split("T")[0]),[S,n]=m.useState(!1);m.useEffect(()=>{t&&(i?(f(i.type),u(i.amount.toString()),y(i.title),w(i.description||""),v(i.category_id||""),z(i.date)):(f(x),u(""),y(""),w(""),v(""),z(new Date().toISOString().split("T")[0])))},[t,x,i]);const o=async r=>{r.preventDefault(),n(!0);try{await l({type:p,amount:parseFloat(d),title:N,description:a||null,category_id:j||null,date:C}),s()}catch(b){console.error(b)}finally{n(!1)}},g=c.filter(r=>r.type===p);return e.jsxs(G,{ref:h,className:`relative transform overflow-hidden rounded-xl bg-brand-neutral-dark border border-brand-depth text-left \r
                        shadow-xl transition-all sm:my-8 w-full sm:max-w-lg`,children:[e.jsx(se,{type:p,onClose:s}),e.jsxs("form",{onSubmit:o,className:"p-4 sm:p-6 space-y-4",children:[e.jsx(re,{type:p,setType:f}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-brand-neutral-light",children:"Kwota"}),e.jsx("input",{type:"number",step:"0.01",min:"0",required:!0,value:d,onChange:r=>u(r.target.value),className:`mt-1 block w-full rounded-md border border-brand-depth bg-brand-neutral-light/5 px-3 py-2 \r
                  text-brand-neutral-light focus:border-brand-accent-1 focus:ring-1 focus:ring-brand-accent-1 \r
                    focus:outline-none sm:text-sm`,placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-brand-neutral-light",children:"Tytuł"}),e.jsx("input",{type:"text",required:!0,value:N,onChange:r=>y(r.target.value),className:`mt-1 block w-full rounded-md border border-brand-depth bg-brand-neutral-light/5 px-3 py-2 \r
                    text-brand-neutral-light focus:border-brand-accent-1 focus:ring-1 focus:ring-brand-accent-1 \r
                      focus:outline-none sm:text-sm`,placeholder:"np. Zakupy spożywcze"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-brand-neutral-light",children:"Kategoria (opcjonalnie)"}),e.jsxs("select",{value:j,onChange:r=>v(r.target.value),className:"mt-1 block w-full rounded-md border border-brand-depth bg-brand-neutral-light/5 px-3 py-2 text-brand-neutral-light focus:border-brand-accent-1 focus:ring-1 focus:ring-brand-accent-1 focus:outline-none sm:text-sm appearance-none",children:[e.jsx("option",{value:"",className:"bg-brand-neutral-dark",children:"Wybierz kategorię"}),g.map(r=>e.jsx("option",{value:r.id,className:"bg-brand-neutral-dark",children:r.name},r.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-brand-neutral-light",children:"Data"}),e.jsx("input",{type:"date",required:!0,value:C,onChange:r=>z(r.target.value),className:"mt-1 block w-full rounded-md border border-brand-depth bg-brand-neutral-light/5 px-3 py-2 text-brand-neutral-light focus:border-brand-accent-1 focus:ring-1 focus:ring-brand-accent-1 focus:outline-none sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-brand-neutral-light",children:"Opis (opcjonalnie)"}),e.jsx("textarea",{value:a,onChange:r=>w(r.target.value),rows:3,className:`mt-1 block w-full rounded-md border border-brand-depth bg-brand-neutral-light/5 px-3 py-2 text-brand-neutral-light \r
                  focus:border-brand-accent-1 focus:ring-1 focus:ring-brand-accent-1 focus:outline-none sm:text-sm`})]}),e.jsx("div",{className:"mt-5 sm:mt-6",children:e.jsx("button",{type:"submit",disabled:S,className:`inline-flex w-full justify-center rounded-md bg-brand-accent-1 px-3 py-2 text-sm font-semibold text-brand-neutral-dark shadow-sm \r
                    hover:bg-brand-accent-2 focus-visible:outline focus-visible:outline-offset-2 focus-visible:outline-brand-accent-1 disabled:opacity-50\r
                    disabled:cursor-not-allowed cursor-pointer`,children:S?"Zapisywanie...":"Zapisz"})})]})]})});Z.displayName="EntryForm";function W({isOpen:t,onClose:s,onSubmit:l,categories:c,initialType:x="expense",initialData:i}){return e.jsx(H,{show:t,as:m.Fragment,children:e.jsxs(U,{as:"div",className:"relative z-50",onClose:s,children:[e.jsx(E,{as:m.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-brand-neutral-dark/80"})}),e.jsx("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-2 text-center sm:p-0",children:e.jsx(E,{as:m.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:e.jsx(Z,{isOpen:t,onClose:s,onSubmit:l,categories:c,initialType:x,initialData:i})})})})]})})}const P="#9ca3af",ae={Płatności:"#f87171",Transport:"#fb923c",Jedzenie:"#fbbf24",Codzienne:"#2dd4bf",Zdrowie:"#34d399",Dom:"#60a5fa",Samorozwój:"#f472b6",Rozrywka:"#e879f9",Oszczędności:"#4ade80",Wynagrodzenie:"#4ade80",Inwestycje:"#818cf8",Prezenty:"#2dd4bf",Inne:"#9ca3af"},O=t=>t&&ae[t]||P,A="payments",le={Płatności:"payments",Transport:"directions_car",Jedzenie:"restaurant",Codzienne:"shopping_cart",Zdrowie:"medical_services",Dom:"home",Samorozwój:"person",Rozrywka:"theater_comedy",Oszczędności:"save",Wynagrodzenie:"payments",Inwestycje:"",Prezenty:"",Inne:"category"},I=t=>t&&le[t]||A;function ie({transaction:t,categories:s,onDelete:l,onEdit:c}){const[x,i]=m.useState(!1),[h,p]=m.useState(!1),[f,d]=m.useState(!1),u=O(t.finance_categories?.name),N=I(t.finance_categories?.name);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{onClick:()=>i(!x),className:`grid grid-cols-2 p-2 rounded-lg
                   hover:bg-brand-neutral-dark/90 transition-colors duration-300 cursor-pointer ${x?"bg-brand-neutral-dark/60":"bg-brand-neutral-dark/40"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 self-start",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 shrink-0 rounded-full text-brand-neutral-light",style:{backgroundColor:`${u}21`},children:e.jsx("span",{className:"material-symbols-sharp",style:{color:u},children:N})}),e.jsxs("div",{className:"flex flex-col justify-center",children:[e.jsx("span",{className:`font-medium text-brand-neutral-light text-sm line-clamp-2 overflow-hidden \r
                          text-ellipsis`,children:t.title}),e.jsx("span",{className:"text-xs text-brand-secondary",children:t.finance_categories?t.finance_categories.name:"Nieskategoryzowane"})]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-start h-full gap-1",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:`font-bold text-sm whitespace-nowrap ${t.type==="income"?"text-brand-positive-lighter":"text-brand-negative"}`,children:[t.type==="income"?"+":"-",t.amount.toFixed(2),e.jsx("span",{className:"text-xs ml-1",children:"PLN"})]})}),x?e.jsxs("div",{className:"flex items-end justify-end gap-1",children:[e.jsx("button",{onClick:y=>{y.stopPropagation(),d(!0)},className:`flex items-center p-1 text-brand-neutral-light hover:bg-brand-neutral-light/10\r
                      rounded-full transition-all cursor-pointer`,title:"Edytuj",children:e.jsx(J,{className:"scale-80"})}),e.jsx("button",{onClick:y=>{y.stopPropagation(),p(!0)},className:`flex items-center p-1 text-brand-negative hover:bg-brand-negative/10\r
                      rounded-full transition-all cursor-pointer`,title:"Usuń",children:e.jsx(Q,{})})]}):null]}),x?e.jsxs("div",{className:`col-span-2 bg-brand-neutral-dark/40 p-2 -mx-2 -mb-2 rounded-b-lg ${t.title.length>15?"mt-2":""}`,children:[e.jsx("div",{className:"text-sm text-brand-neutral-light font-semibold text-wrap break-words px-1",children:t.title}),e.jsx("div",{className:"text-xs text-brand-secondary/80 text-wrap break-words p-1",children:t.description?t.description:"Brak opisu"})]}):null]}),e.jsx(ee,{isOpen:h,onClose:()=>p(!1),onConfirm:()=>l(t.id),description:e.jsxs("p",{children:["Czy na pewno chcesz usunąć transakcję"," ",e.jsx("strong",{className:"text-brand-neutral-light",children:t.title}),"? Tej akcji nie można cofnąć."]})}),e.jsx(W,{isOpen:f,onClose:()=>d(!1),onSubmit:y=>c(t.id,y),categories:s,initialData:t})]})}function de({date:t,transactions:s,categories:l,onDelete:c,onEdit:x}){const i=new Intl.DateTimeFormat("pl-PL",{weekday:"long",day:"numeric",month:"long"});return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-px bg-brand-depth"}),e.jsx("h3",{className:"text-xs font-bold text-brand-secondary uppercase tracking-wider",children:i.format(new Date(t))}),e.jsx("div",{className:"flex-1 h-px bg-brand-depth"})]}),e.jsx("div",{className:"space-y-2",children:s.map(h=>e.jsx(ie,{transaction:h,categories:l,onDelete:c,onEdit:x},h.id))})]})}function oe(){return e.jsx("div",{className:"relative overflow-hidden",children:e.jsx("div",{className:"space-y-4",children:[1,2,3].map(t=>e.jsx("div",{className:"h-16 bg-brand-neutral-dark/30 rounded-lg animate-pulse"},t))})})}function D({name:t,isActive:s,onToggle:l}){const c=O(t),x=I(t);return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-brand-neutral-dark/30 rounded-xl border border-brand-depth/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-brand-primary-dark",style:{backgroundColor:c},children:e.jsx("span",{className:"material-symbols-sharp",children:x})}),e.jsx("span",{className:"font-medium text-sm md:text-base text-brand-neutral-light",children:t})]}),e.jsx("button",{onClick:()=>l(!s),className:`relative w-12 h-6 rounded-full transition-colors duration-200 ease-in-out cursor-pointer ${s?"bg-brand-accent-1":"bg-brand-neutral-dark"}`,children:e.jsx(_.div,{initial:!1,animate:{x:s?26:7},className:"absolute top-1 w-4 h-4 rounded-full bg-white shadow-sm"})})]})}function K({isOpen:t,onClose:s,categories:l,onToggleCategory:c,showIncomeCategories:x=!1,onToggleAll:i}){const h=l.filter(a=>a.type==="expense").map(a=>a.name),p=l.filter(a=>a.type==="income").map(a=>a.name),f=Array.from(new Set(h)),d=Array.from(new Set(p)),u=(a,w)=>{const j=l.find(v=>v.name===a&&v.type===w);return j?j.is_active:!1},N=a=>(a==="expense"?f:d).every(j=>u(j,a)),y=a=>{if(i){const w=!N(a);i(a,w)}};return e.jsx(te,{children:t&&e.jsxs(e.Fragment,{children:[e.jsx(_.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:s,className:"fixed inset-0 bg-brand-neutral-darker/70 backdrop-blur-sm z-50"}),e.jsx(_.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"fixed inset-0 flex items-center justify-center z-50 pointer-events-none",children:e.jsxs("div",{className:`overflow-hidden flex flex-col w-full max-w-2xl max-h-[85vh] bg-brand-neutral-darker border border-brand-depth \r
                          rounded-2xl shadow-2xl pointer-events-auto mx-4`,children:[e.jsxs("div",{className:"p-6 border-b border-brand-depth flex justify-between items-center bg-brand-neutral-dark/50",children:[e.jsx("h2",{className:"text-xl font-bold text-brand-neutral-light",children:"Aktywne kategorie"}),e.jsx("button",{onClick:s,className:`text-brand-secondary hover:text-brand-neutral-dark hover:bg-brand-neutral-light/70 rounded-full \r
                  p-1 flex items-center justify-center cursor-pointer transition-all`,children:e.jsx(R,{})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[e.jsxs("section",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-1",children:[e.jsx("h3",{className:"text-sm uppercase tracking-wider text-brand-negative font-semibold",children:"Wydatki"}),i&&e.jsx("button",{onClick:()=>y("expense"),className:"text-xs font-medium text-brand-accent-1 hover:text-brand-accent-2 transition-colors cursor-pointer",children:N("expense")?"Odznacz wszystkie":"Zaznacz wszystkie"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:f.map(a=>e.jsx(D,{name:a,isActive:u(a,"expense"),onToggle:()=>c(a,"expense")},`expense-${a}`))})]}),x&&e.jsxs("section",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-1 border-t border-brand-depth pt-6",children:[e.jsx("h3",{className:"text-sm uppercase tracking-wider text-brand-positive font-semibold",children:"Przychody"}),i&&e.jsx("button",{onClick:()=>y("income"),className:"text-xs font-medium text-brand-accent-1 hover:text-brand-accent-2 transition-colors cursor-pointer",children:N("income")?"Odznacz wszystkie":"Zaznacz wszystkie"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:d.map(a=>e.jsx(D,{name:a,isActive:u(a,"income"),onToggle:()=>c(a,"income")},`income-${a}`))})]})]}),e.jsx("div",{className:"p-4 border-t border-brand-depth bg-brand-neutral-dark/30 text-center",children:e.jsx("p",{className:"text-xs text-brand-neutral-light/50",children:"Wybierz kategorie, które chcesz widzieć."})})]})})]})})}function ce({transactions:t,categories:s,isLoading:l,onDelete:c,onEdit:x}){const[i,h]=m.useState(new Set),[p,f]=m.useState(!1);if(l)return e.jsx(oe,{});if(t.length===0)return e.jsx("div",{className:"text-center text-brand-secondary py-8",children:"Brak transakcji. Dodaj pierwszą!"});const d=new Map;t.forEach(n=>{if(n.finance_categories){const o=`${n.finance_categories.name}-${n.finance_categories.type}`;d.has(o)||d.set(o,n.finance_categories)}});const u=(n,o)=>{const g=`${n}-${o}`;h(r=>{const b=new Set(r);return b.has(g)?b.delete(g):b.add(g),b})},N=(n,o)=>{h(g=>{const r=new Set(g);return Array.from(d.values()).filter(k=>k.type===n).forEach(k=>{const T=`${k.name}-${k.type}`;o?r.delete(T):r.add(T)}),r})},y=()=>{h(new Set)},w=t.filter(n=>{if(n.finance_categories){const o=`${n.finance_categories.name}-${n.finance_categories.type}`;if(i.has(o))return!1}return!0}).reduce((n,o)=>{const g=o.date;return n[g]||(n[g]=[]),n[g].push(o),n},{}),j=Object.keys(w).sort((n,o)=>new Date(o).getTime()-new Date(n).getTime()),v=Array.from(d.values()).map(n=>({...n,is_active:!i.has(`${n.name}-${n.type}`)})),C=v.filter(n=>n.is_active).length,z=v.length,S=i.size>0;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center mb-4",children:[e.jsx("div",{className:"flex gap-2 justify-start w-full sm:w-auto",children:e.jsx("button",{onClick:()=>f(!0),className:`py-1 px-2 flex items-center justify-center rounded-lg transition-colors ${S?"bg-brand-accent-1 text-brand-neutral-darker hover:bg-brand-accent-1/80 cursor-pointer":"bg-brand-neutral-dark/50 text-brand-secondary hover:bg-brand-neutral-dark/70 cursor-pointer"}`,children:e.jsx("span",{className:"material-symbols-sharp",children:"filter_list"})})}),S&&e.jsxs("button",{onClick:y,className:"text-end text-xs text-brand-secondary hover:text-brand-accent-1 transition-colors cursor-pointer sm:ml-1",children:["Aktywne filtry: ",C,"/",z," (kliknij, aby wyczyścić)"]})]}),j.length>0?j.map(n=>e.jsx(de,{date:n,transactions:w[n],categories:s,onDelete:c,onEdit:x},n)):e.jsx("div",{className:"flex flex-col items-center justify-center py-8 text-brand-secondary",children:e.jsx("p",{className:"text-sm",children:"Brak transakcji spełniających kryteria"})}),e.jsx(K,{isOpen:p,onClose:()=>f(!1),categories:v,onToggleCategory:u,onToggleAll:N,showIncomeCategories:!0})]})}function B({category:t,amount:s,spent:l,editMode:c,editValue:x,onEdit:i}){const h=O(t.name),p=I(t.name),f=x!==void 0?x:s.toString();return e.jsx("div",{children:e.jsxs("div",{className:`grid grid-cols-[minmax(0,1fr)_auto] rounded-xl bg-brand-neutral-dark/40 \r
                  hover:bg-brand-neutral-dark/80 transition-colors`,children:[e.jsxs("div",{className:"flex items-center gap-1 min-w-0",children:[e.jsx("div",{className:`w-10 min-h-10 ml-1 rounded-l-xl flex items-center justify-center\r
                      text-brand-neutral-light shrink-0`,style:{color:`${h}`},children:e.jsx("span",{className:"material-symbols-sharp",children:p})}),e.jsx("span",{className:"font-semibold text-sm sm:text-base text-brand-neutral-light truncate",children:t.name})]}),e.jsx("div",{className:"flex justify-between items-center min-h-10 ml-auto  px-4 py-1.5 rounded-r-xl",children:c?e.jsx("input",{type:"number",value:f,onChange:d=>i?.(d.target.value),className:`w-full bg-brand-neutral-light/5 border border-brand-depth rounded-lg px-3 py-2 text-sm text-brand-neutral-light focus:outline-none \r
                        focus:border-brand-accent-2 transition-colors`,autoFocus:!0,placeholder:"0"}):e.jsxs("p",{className:"font-bold text-brand-neutral-light/60",children:[e.jsx("span",{className:`text-md md:text-xl font-medium uppercase     
                            tracking-wider mt-0.5 ${l>s?"text-brand-negative":"text-brand-neutral-light"}`,children:e.jsx("span",{className:"text-lg md:text-xl",children:l.toFixed(0)})}),e.jsx("span",{className:"text-xs md:text-sm mx-1 text-brand-neutral-light/60",children:"/"}),e.jsxs("span",{className:"text-sm md:text-base",children:[s.toFixed(0)," "]}),e.jsx("span",{className:"text-xs md:text-sm font-normal text-brand-secondary",children:"PLN"})]})})]})})}function xe({categories:t,budgets:s,onSaveBudget:l,categorySpending:c,onToggleCategory:x}){const[i,h]=m.useState(!1),p=t.filter(n=>n.is_active),f=p.filter(n=>n.type==="expense"),d=p.filter(n=>n.type==="income"),u=f.reduce((n,o)=>n+(c[o.id]||0),0),N=s.filter(n=>p.some(o=>o.id===n.category_id)).reduce((n,o)=>n+o.amount,0),[y]=m.useState("expense"),[a,w]=m.useState(!1),[j,v]=m.useState({}),C=()=>{a?S():(v({}),w(!0))},z=(n,o)=>{v(g=>({...g,[n]:o}))},S=async()=>{const n=Object.entries(j).map(([o,g])=>{const r=parseFloat(g);return isNaN(r)||r<0?Promise.resolve():l(o,r)});await Promise.all(n),w(!1),v({})};return e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex gap-2 items-center justify-between text-brand-neutral-light font-semibold",children:[e.jsx("button",{className:"px-4 py-2 rounded-lg bg-brand-secondary/80 hover:bg-brand-neutral-dark/70 transition-colors cursor-pointer",onClick:()=>h(!0),children:"Kategorie"}),e.jsxs("span",{className:`hidden sm:block text-brand-neutral-light bg-brand-neutral-dark px-8 py-2 -mb-7 rounded-t-full \r
                      font-semibold text-xl lg:text-lg text-center`,children:[u," /"," ",e.jsx("span",{className:"text-brand-accent-1 font-bold",children:N}),e.jsx("span",{className:"text-xs ml-1 font-normal",children:"PLN"})]}),e.jsx("button",{className:"px-4 py-2 rounded-lg bg-brand-secondary/80 hover:bg-brand-neutral-dark/70 transition-colors cursor-pointer",onClick:C,children:a?"Zapisz":"Edytuj"})]}),e.jsxs("span",{className:`block sm:hidden mx-auto mt-1 text-brand-neutral-light bg-brand-neutral-dark px-8 pt-2 pb-1 -mb-3 max-w-60 \r
                      rounded-t-full font-semibold text-lg text-center`,children:[u," /"," ",e.jsx("span",{className:"text-brand-accent-1 font-bold",children:N}),e.jsx("span",{className:"text-xs ml-1 font-normal",children:"PLN"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"h-5 w-full rounded-full bg-brand-neutral-dark overflow-hidden flex mb-1",children:e.jsx("div",{className:"h-full bg-brand-accent-3",style:{width:`${u/N*100}%`}})}),y==="expense"?f.map(n=>{const o=s.find(k=>k.category_id===n.id),g=o?o.amount:0,r=c[n.id]||0,b=j[n.id];return e.jsx(B,{category:n,amount:g,spent:r,editMode:a,editValue:b,onEdit:k=>z(n.id,k),onSave:async()=>{}},n.id)}):d.map(n=>{const o=s.find(k=>k.category_id===n.id),g=o?o.amount:0,r=c[n.id]||0,b=j[n.id];return e.jsx(B,{category:n,amount:g,spent:r,editMode:a,editValue:b,onEdit:k=>z(n.id,k),onSave:async()=>{}},n.id)})]}),e.jsx(K,{isOpen:i,onClose:()=>h(!1),categories:t,onToggleCategory:x})]})}function me({income:t,expense:s}){const l=t+s;let c=0;return l>0&&(c=t/l*100),l===0?e.jsx("div",{className:"relative flex items-center justify-center",children:e.jsx("div",{className:`flex items-center justify-center relative w-32 h-32 lg:w-64 lg:h-64 \r
                  bg-brand-neutral-dark border-4 border-brand-depth rounded-full \r
                  transition-all duration-300`,children:e.jsx("span",{className:"font-medium text-xs lg:text-lg text-brand-secondary uppercase tracking-wider",children:"Brak danych"})})}):e.jsx("div",{className:"relative flex items-center justify-center",children:e.jsx("div",{className:"w-64 h-64 rounded-full shadow-lg shadow-black/30 transition-all duration-300",style:{background:`conic-gradient(
                      var(--color-brand-positive) 0% ${c}%, 
                      var(--color-brand-negative) ${c}% 100%)`},children:e.jsxs("div",{className:`flex flex-col items-center justify-center absolute inset-0 m-auto w-42 h-42 \r
                    bg-brand-neutral-dark rounded-full border-4 border-brand-neutral-light/5 \r
                    transition-all duration-300`,children:[e.jsx("span",{className:"text-xs text-brand-secondary uppercase tracking-wider",children:"Bilans"}),e.jsxs("span",{className:`text-3xl font-bold ${t-s>=0?"text-brand-positive-lighter":"text-brand-negative"}`,children:[t-s>0?"+":"",(t-s).toFixed(0),e.jsx("span",{className:"text-lg font-normal text-brand-secondary ml-1",children:"PLN"})]})]})})})}function ue({stats:t,moneyLeft:s,totalBudget:l}){return e.jsx("div",{className:"bg-brand-neutral-dark/40 border border-brand-depth rounded-2xl p-6 relative",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 lg:gap-0",children:[e.jsxs("div",{className:"flex flex-col gap-4 order-2 lg:order-1",children:[e.jsx($,{type:"income",amount:t.income}),e.jsx($,{type:"expense",amount:t.expense})]}),e.jsx(_.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",duration:.8},className:"order-1 lg:order-2 lg:-mt-16 overflow-visible",children:e.jsx(me,{income:Math.abs(t.income),expense:Math.abs(t.expense)})}),e.jsx(V,{moneyLeft:s,totalBudget:l})]})})}const L=({handleOpenModal:t,incOrExp:s})=>e.jsxs("button",{onClick:()=>t(s),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium 
                  transition-colors border cursor-pointer ${s==="expense"?"bg-brand-negative/10 text-brand-negative border-brand-negative hover:bg-brand-negative/20":"bg-brand-positive/10 text-brand-positive border-brand-positive hover:bg-brand-positive/20"}`,children:[e.jsx("span",{className:"material-symbols-sharp",children:s==="expense"?"remove":"add"}),e.jsx("span",{children:s==="expense"?"Wydatek":"Przychód"})]}),F=({category:t,amount:s})=>{const l=O(t.name),c=I(t.name);return e.jsx("div",{children:e.jsxs("div",{className:`grid grid-cols-[minmax(0,1fr)_auto] \r
                  transition-colors rounded-xl border-1 border-brand-depth/10`,style:{backgroundColor:`color-mix(in srgb, ${l}, gray 50%)`,backgroundImage:"linear-gradient(rgba(0,0,0,0.33), rgba(0,0,0,0.37))"},children:[e.jsxs("div",{className:"flex items-center gap-1 min-w-0",children:[e.jsx("div",{className:`w-10 min-h-10 ml-1 rounded-l-xl flex items-center justify-center\r
                      text-brand-neutral-light shrink-0`,style:{color:`${l}`},children:e.jsx("span",{className:"material-symbols-sharp",children:c})}),e.jsx("span",{className:"font-semibold text-sm sm:text-base text-brand-neutral-light truncate",children:t.name})]}),e.jsx("div",{className:"flex justify-between items-center min-h-10 ml-auto  px-4 py-1.5 rounded-r-xl",children:e.jsxs("p",{className:"font-bold text-brand-neutral-light/60",children:[e.jsx("span",{className:`text-md md:text-xl font-medium uppercase     
                            tracking-wider mt-0.5`,style:{color:`${l}`,filter:"brightness(1.33)"},children:e.jsx("span",{className:"text-lg md:text-xl",children:s.toFixed(0)})}),e.jsxs("span",{className:"text-xs md:text-sm font-normal text-brand-secondary",children:[" ","PLN"]})]})})]})})};function be({categories:t,categorySpending:s,stats:l}){const c=t.filter(d=>d.type==="expense"&&(s[d.id]||0)!==0),x=t.filter(d=>d.type==="income"&&(s[d.id]||0)!==0),i=x.reduce((d,u)=>d+(s[u.id]||0),0),h=c.reduce((d,u)=>d+(s[u.id]||0),0),p=l.income-i,f=l.expense-h;return e.jsx("div",{children:e.jsx("div",{className:"flex flex-col h-full relative max-w-80 sm:max-w-142 lg:max-w-none mx-auto",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 md:gap-2  relative z-10",children:[x.length>0&&e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("h3",{className:`text-xl font-bold text-brand-positive-lighter bg-brand-neutral-dark\r
                            w-3/4 text-center py-2 rounded-t-3xl mx-auto`,children:"Przychody"}),x.map(d=>{const u=s[d.id]||0;return e.jsx(F,{category:d,amount:u},d.id)}),p>0&&e.jsx(F,{category:{id:"uncat-inc",name:"Nieskategoryzowane",type:"income",is_active:!0,user_id:"",created_at:""},amount:p},"uncategorised-income"),e.jsx("h3",{className:`text-xl font-bold text-brand-negative bg-brand-neutral-dark\r
                            w-3/4 text-center h-6 rounded-b-full mx-auto -mt-0.5`})]}),c.length>0&&e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("h3",{className:`text-xl font-bold text-brand-negative bg-brand-neutral-dark\r
                            w-3/4 text-center h-6 rounded-t-full mx-auto -mt-0.5`}),c.map(d=>{const u=s[d.id]||0;return e.jsx(F,{category:d,amount:u},d.id)}),f>0&&e.jsx(F,{category:{id:"uncat-exp",name:"Nieskategoryzowane",type:"expense",is_active:!0,user_id:"",created_at:""},amount:f},"uncategorised-expense"),e.jsx("h3",{className:`text-xl font-bold text-brand-negative bg-brand-neutral-dark\r
                            w-3/4 text-center py-2 rounded-b-3xl mx-auto -mt-0.5`,children:"Wydatki"})]})]})})})}function ve(){const{transactions:t,categories:s,budgets:l,isLoading:c,addTransaction:x,deleteTransaction:i,editTransaction:h,saveBudget:p,toggleCategory:f}=X(),[d,u]=m.useState(!1),[N,y]=m.useState("expense"),[a,w]=m.useState(new Date),[j,v]=m.useState("budget"),C=m.useMemo(()=>{const r=a.getMonth(),b=a.getFullYear();return t.filter(k=>{const T=new Date(k.date);return T.getMonth()===r&&T.getFullYear()===b})},[t,a]),z=m.useMemo(()=>C.reduce((r,b)=>(b.type==="income"?r.income+=b.amount:r.expense+=b.amount,r),{income:0,expense:0}),[C]),S=m.useMemo(()=>l.reduce((r,b)=>r+(b.amount||0),0),[l]),n=m.useMemo(()=>C.reduce((r,b)=>(b.category_id&&(r[b.category_id]=(r[b.category_id]||0)+b.amount),r),{}),[C]),o=S-z.expense,g=r=>{y(r),u(!0)};return e.jsxs(_.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"py-6 lg:p-8 mx-auto space-y-3 xl:h-[calc(100vh)]",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsx(ne,{selectedDate:a,onDateChange:w,format:"month"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(L,{handleOpenModal:g,incOrExp:"expense"}),e.jsx(L,{handleOpenModal:g,incOrExp:"income"})]})]}),e.jsx(ue,{stats:z,moneyLeft:o,totalBudget:S}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"",children:[e.jsx("div",{className:"flex items-end lg:justify-end",children:e.jsx("h2",{className:`bg-brand-neutral-dark/50 text-xl font-bold text-brand-neutral-light border border-brand-depth \r
                          rounded-t-xl py-2 px-4`,children:"Historia"})}),e.jsx("div",{className:`flex-grow overflow-y-auto max-h-[86vh] lg:max-h-[57vh] bg-brand-neutral-dark/40 border border-brand-depth \r
                        rounded-b-2xl rounded-tr-2xl lg:rounded-tr-none lg:rounded-tl-2xl p-4 sm:pb-8 lg:py-4 md:px-6`,children:e.jsx(ce,{transactions:C,categories:s,isLoading:c,onDelete:i,onEdit:h})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{label:"Budżet",value:"budget",isSelected:j==="budget",setSelectedTab:v}),e.jsx(M,{label:"Zestawienie",value:"stats",isSelected:j==="stats",setSelectedTab:v,disabled:t.length===0})]})}),e.jsx("div",{className:"overflow-y-auto max-h-[86vh] lg:max-h-[57vh] bg-brand-neutral-dark/40 border border-brand-depth rounded-b-2xl rounded-tr-2xl p-4 md:px-6",children:j==="budget"?e.jsx(xe,{categories:s,budgets:l,onSaveBudget:p,categorySpending:n,onToggleCategory:f}):e.jsx(be,{categories:s,categorySpending:n,stats:z})})]})]}),e.jsx(W,{isOpen:d,onClose:()=>u(!1),onSubmit:x,categories:s,initialType:N})]})}export{ve as default};
