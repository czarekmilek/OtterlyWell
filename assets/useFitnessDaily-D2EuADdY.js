import{r as l,s as n,a as k}from"./index-Bol5J1mE.js";function E(){const[d,t]=l.useState(!1),[g,u]=l.useState([]),f=async()=>{t(!0);const{data:{user:i}}=await n.auth.getUser();if(!i)return;const{data:c,error:r}=await n.from("workout_sets").select("*, items:workout_set_items(*)").eq("created_by",i.id).not("scheduled_day","is",null);r?console.error("Error fetching weekly plan:",r):u(c||[]),t(!1)};return l.useEffect(()=>{f()},[]),{loading:d,weeklyPlan:g,updateScheduledDay:async(i,c)=>{if(!i)return;const{data:{user:r}}=await n.auth.getUser();if(!r)return;c!==null&&await n.from("workout_sets").update({scheduled_day:null}).eq("created_by",r.id).eq("scheduled_day",c);const{error:e}=await n.from("workout_sets").update({scheduled_day:c}).eq("id",i);e?console.error("Error updating scheduled day:",e):await f()},getDayPlan:i=>g.find(c=>c.scheduled_day===i),refreshPlan:f}}function m(d){const{user:t}=k(),[g,u]=l.useState([]),[f,y]=l.useState(!0);return l.useEffect(()=>{if(!t)return;async function r(){if(!t)return;y(!0);const e=new Date(d);e.setHours(0,0,0,0);const s=new Date(d);s.setHours(23,59,59,999);const{data:o,error:a}=await n.from("workout_logs").select("*, exercise:exercises(*)").eq("user_id",t.id).gte("created_at",e.toISOString()).lte("created_at",s.toISOString()).order("created_at",{ascending:!0});a?console.error("Error fetching workout logs",a):o&&u(o),y(!1)}r()},[t,d]),{entries:g,isLoading:f,addEntry:async(r,e)=>{if(!t)return;const s={user_id:t.id,exercise_id:r.id,sets:e.sets,reps:e.reps,weight_kg:e.weight,duration_min:e.duration,distance_km:e.distance,created_at:d.toISOString()},{data:o,error:a}=await n.from("workout_logs").insert(s).select("*, exercise:exercises(*)").single();a?console.error("Error adding workout log",a):o&&u(_=>[..._,o])},removeEntry:async r=>{const{error:e}=await n.from("workout_logs").delete().eq("id",r);e?console.error("Error deleting workout log",e):u(s=>s.filter(o=>o.id!==r))},editEntry:async(r,e)=>{const{error:s}=await n.from("workout_logs").update(e).eq("id",r);s?console.error("Error updating workout log",s):u(o=>o.map(a=>a.id===r?{...a,...e}:a))}}}export{m as a,E as u};
